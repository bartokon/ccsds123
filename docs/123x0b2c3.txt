Recommendation for Space Data System Standards

LOW-COMPLEXITY LOSSLESS
AND NEAR-LOSSLESS
MULTISPECTRAL AND
HYPERSPECTRAL IMAGE
COMPRESSION

RECOMMENDED STANDARD
CCSDS 123.0-B-2

BLUE BOOK
February 2019

Note:
This current
issue includes
all updates through
Technical Corrigendum 3,
dated February 2021

Recommendation for Space Data System Standards

LOW-COMPLEXITY LOSSLESS
AND NEAR-LOSSLESS
MULTISPECTRAL AND
HYPERSPECTRAL IMAGE
COMPRESSION

RECOMMENDED STANDARD
CCSDS 123.0-B-2

BLUE BOOK
February 2019

Note:
This current
issue includes
all updates through
Technical Corrigendum 3,
dated February 2021

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

AUTHORITY

Issue:
Date:
Location:

Recommended Standard, Issue 2
February 2019
Washington, DC, USA

This document has been approved for publication by the Management Council of the
Consultative Committee for Space Data Systems (CCSDS) and represents the consensus
technical agreement of the participating CCSDS Member Agencies. The procedure for
review and authorization of CCSDS documents is detailed in Organization and Processes for
the Consultative Committee for Space Data Systems (CCSDS A02.1-Y-4), and the record of
Agency participation in the authorization of this document can be obtained from the CCSDS
Secretariat at the email address below.
This document is published and maintained by:
CCSDS Secretariat
National Aeronautics and Space Administration
Washington, DC, USA
Email: secretariat@mailman.ccsds.org

CCSDS 123.0-B-2

Page i

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

STATEMENT OF INTENT
The Consultative Committee for Space Data Systems (CCSDS) is an organization officially
established by the management of its members. The Committee meets periodically to address
data systems problems that are common to all participants, and to formulate sound technical
solutions to these problems. Inasmuch as participation in the CCSDS is completely
voluntary, the results of Committee actions are termed Recommended Standards and are
not considered binding on any Agency.
This Recommended Standard is issued by, and represents the consensus of, the CCSDS
members. Endorsement of this Recommendation is entirely voluntary. Endorsement,
however, indicates the following understandings:
o

Whenever a member establishes a CCSDS-related standard, this standard will be in
accord with the relevant Recommended Standard. Establishing such a standard
does not preclude other provisions which a member may develop.

o

Whenever a member establishes a CCSDS-related standard, that member will
provide other CCSDS members with the following information:
-- The standard itself.
-- The anticipated date of initial operational capability.
-- The anticipated duration of operational service.

o

Specific service arrangements shall be made via memoranda of agreement. Neither
this Recommended Standard nor any ensuing standard is a substitute for a
memorandum of agreement.

No later than five years from its date of issuance, this Recommended Standard will be
reviewed by the CCSDS to determine whether it should: (1) remain in effect without change;
(2) be changed to reflect the impact of new technologies, new requirements, or new
directions; or (3) be retired or canceled.
In those instances when a new version of a Recommended Standard is issued, existing
CCSDS-related member standards and implementations are not negated or deemed to be
non-CCSDS compatible. It is the responsibility of each member to determine when such
standards or implementations are to be modified. Each member is, however, strongly
encouraged to direct planning for its new standards and implementations towards the later
version of the Recommended Standard.

CCSDS 123.0-B-2

Page ii

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

FOREWORD
This Recommended Standard specifies a method for lossless and near-lossless compression
of multispectral and hyperspectral image data and a format for storing the compressed data.
Attention is drawn to the possibility that some of the elements of this document may be the
subject of patent rights. CCSDS has processes for identifying patent issues and for securing
from the patent holder agreement that all licensing policies are reasonable and nondiscriminatory. However, CCSDS does not have a patent law staff, and CCSDS shall not be
held responsible for identifying any or all such patent rights.
Through the process of normal evolution, it is expected that expansion, deletion, or
modification of this document may occur. This Recommended Standard is therefore subject
to CCSDS document management and change control procedures, which are defined in
Organization and Processes for the Consultative Committee for Space Data Systems
(CCSDS A02.1-Y-4). Current versions of CCSDS documents are maintained at the CCSDS
Web site:
http://www.ccsds.org/
Questions relating to the contents or status of this document should be sent to the CCSDS
Secretariat at the email address indicated on page i.

CCSDS 123.0-B-2

Page iii

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

At time of publication, the active Member and Observer Agencies of the CCSDS were:
Member Agencies
– Agenzia Spaziale Italiana (ASI)/Italy.
– Canadian Space Agency (CSA)/Canada.
– Centre National d’Etudes Spatiales (CNES)/France.
– China National Space Administration (CNSA)/People’s Republic of China.
– Deutsches Zentrum für Luft- und Raumfahrt (DLR)/Germany.
– European Space Agency (ESA)/Europe.
– Federal Space Agency (FSA)/Russian Federation.
– Instituto Nacional de Pesquisas Espaciais (INPE)/Brazil.
– Japan Aerospace Exploration Agency (JAXA)/Japan.
– National Aeronautics and Space Administration (NASA)/USA.
– UK Space Agency/United Kingdom.
Observer Agencies
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–
–

Austrian Space Agency (ASA)/Austria.
Belgian Federal Science Policy Office (BFSPO)/Belgium.
Central Research Institute of Machine Building (TsNIIMash)/Russian Federation.
China Satellite Launch and Tracking Control General, Beijing Institute of Tracking and
Telecommunications Technology (CLTC/BITTT)/China.
Chinese Academy of Sciences (CAS)/China.
China Academy of Space Technology (CAST)/China.
Commonwealth Scientific and Industrial Research Organization (CSIRO)/Australia.
Danish National Space Center (DNSC)/Denmark.
Departamento de Ciência e Tecnologia Aeroespacial (DCTA)/Brazil.
Electronics and Telecommunications Research Institute (ETRI)/Korea.
European Organization for the Exploitation of Meteorological Satellites (EUMETSAT)/Europe.
European Telecommunications Satellite Organization (EUTELSAT)/Europe.
Geo-Informatics and Space Technology Development Agency (GISTDA)/Thailand.
Hellenic National Space Committee (HNSC)/Greece.
Hellenic Space Agency (HSA)/Greece.
Indian Space Research Organization (ISRO)/India.
Institute of Space Research (IKI)/Russian Federation.
Korea Aerospace Research Institute (KARI)/Korea.
Ministry of Communications (MOC)/Israel.
Mohammed Bin Rashid Space Centre (MBRSC)/United Arab Emirates.
National Institute of Information and Communications Technology (NICT)/Japan.
National Oceanic and Atmospheric Administration (NOAA)/USA.
National Space Agency of the Republic of Kazakhstan (NSARK)/Kazakhstan.
National Space Organization (NSPO)/Chinese Taipei.
Naval Center for Space Technology (NCST)/USA.
Research Institute for Particle & Nuclear Physics (KFKI)/Hungary.
Scientific and Technological Research Council of Turkey (TUBITAK)/Turkey.
South African National Space Agency (SANSA)/Republic of South Africa.
Space and Upper Atmosphere Research Commission (SUPARCO)/Pakistan.
Swedish Space Corporation (SSC)/Sweden.
Swiss Space Office (SSO)/Switzerland.
United States Geological Survey (USGS)/USA.

CCSDS 123.0-B-2

Page iv

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

DOCUMENT CONTROL

Document

Title

Date

Status

CCSDS
123.0-B-1

Lossless Multispectral &
Hyperspectral Image Compression,
Recommended Standard,
Issue 1

May 2012

Original issue,
superseded

CCSDS
123.0-B-2

Low-Complexity Lossless and Near- February
Lossless Multispectral and
2019
Hyperspectral Image Compression,
Recommended Standard, Issue 2

Current issue

CCSDS
123.0-B-2

Technical corrigendum 1

July 2019

Corrects items in
Implementation
Conformance Statement
Proforma Requirements
List tables (annex A)

CCSDS
123.0-B-2

Technical corrigendum 2

August 2020 Corrects items in

CCSDS
123.0-B-2

Technical corrigendum 3

February
2021

Cor. 1

Implementation
Conformance Statement
Proforma Requirements
List table A-8.

Cor. 2

Cor. 3

CCSDS 123.0-B-2 Cor. 3

Page v

Adds missing codewords
in two tables in annex B.

February
February2019
2021

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

CONTENTS
Section
1

INTRODUCTION.......................................................................................................... 1-1
1.1
1.2
1.3
1.4
1.5
1.6
1.7

2

GENERAL .............................................................................................................. 2-1
LOSSLESS COMPRESSION ................................................................................ 2-3
BACKWARDS COMPATIBILITY ....................................................................... 2-3
DATA TRANSMISSION ....................................................................................... 2-4

IMAGE............................................................................................................................ 3-1
3.1
3.2
3.3
3.4
3.5

4

PURPOSE ............................................................................................................... 1-1
SCOPE .................................................................................................................... 1-1
APPLICABILITY ................................................................................................... 1-1
RATIONALE.......................................................................................................... 1-1
DOCUMENT STRUCTURE ................................................................................. 1-2
CONVENTIONS AND DEFINITIONS................................................................. 1-2
REFERENCE.......................................................................................................... 1-5

OVERVIEW ................................................................................................................... 2-1
2.1
2.2
2.3
2.4

3

Page

OVERVIEW ........................................................................................................... 3-1
DIMENSIONS ........................................................................................................ 3-1
DYNAMIC RANGE............................................................................................... 3-1
SAMPLE COORDINATE INDICES ..................................................................... 3-2
SUPPLEMENTARY INFORMATION TABLES ................................................. 3-2

PREDICTOR.................................................................................................................. 4-1
4.1 OVERVIEW ........................................................................................................... 4-1
4.2 NUMBER OF BANDS FOR PREDICTION ......................................................... 4-3
4.3 FULL AND REDUCED PREDICTION MODES ................................................. 4-4
4.4 LOCAL SUM ......................................................................................................... 4-4
4.5 LOCAL DIFFERENCES ........................................................................................ 4-5
4.6 WEIGHTS .............................................................................................................. 4-6
4.7 PREDICTION CALCULATION ........................................................................... 4-9
4.8 QUANTIZATION ................................................................................................ 4-10
4.9 SAMPLE REPRESENTATIVES ......................................................................... 4-12
4.10 WEIGHT UPDATE .............................................................................................. 4-13
4.11 MAPPED QUANTIZER INDEX ......................................................................... 4-14

CCSDS 123.0-B-2

Page vi

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

CONTENTS (continued)
Section
5

Page

ENCODER...................................................................................................................... 5-1
5.1
5.2
5.3
5.4

OVERVIEW ........................................................................................................... 5-1
GENERAL .............................................................................................................. 5-2
HEADER ................................................................................................................ 5-2
BODY ................................................................................................................... 5-17

ANNEX A IMPLEMENTATION CONFORMANCE STATEMENT (ICS)
PROFORMA (NORMATIVE) .................................................................... A-1
ANNEX B LOW-ENTROPY CODE TABLES (NORMATIVE) ................................B-1
ANNEX C SECURITY, SANA, AND PATENT CONSIDERATIONS
(INFORMATIVE) ......................................................................................... C-1
ANNEX D REFERENCES (INFORMATIVE)............................................................. D-1
ANNEX E TABLES OF SYMBOLS USED (INFORMATIVE) ..................................E-1
ANNEX F ABBREVIATIONS AND ACRONYMS (INFORMATIVE) ..................... F-1
Figure
2-1
4-1
4-2
4-3
5-1

Compressor Schematic ................................................................................................. 2-2
Typical Prediction Neighborhood................................................................................. 4-1
Samples Used to Calculate Local Sums ....................................................................... 4-2
Computing Local Differences in a Spectral Band ........................................................ 4-3
Compressed Image Structure ........................................................................................ 5-2

Table
2-1 Backwards Compatibility with CCSDS-123.0-B-1 ...................................................... 2-3
3-1 Supplementary Information Table Purpose .................................................................. 3-3
5-1 Header Structure ........................................................................................................... 5-2
5-2 Image Metadata Structure ............................................................................................. 5-3
5-3 Essential Subpart Structure ........................................................................................... 5-3
5-4 Supplementary Information Table Structure ................................................................ 5-4
5-5 Predictor Metadata Structure ........................................................................................ 5-6
5-6 Primary Structure .......................................................................................................... 5-7
5-7 Weight Tables Subpart Structure .................................................................................. 5-8
5-8 Quantization Subpart Structure..................................................................................... 5-9
5-9 Error Limit Update Period Block Structure ................................................................ 5-10
5-10 Absolute Error Limit Block Structure ........................................................................ 5-10
5-11 Relative Error Limit Block Structure ......................................................................... 5-11
5-12 Sample Representative Subpart Structure .................................................................. 5-12

CCSDS 123.0-B-2

Page vii

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

CONTENTS (continued)
Table

Page

5-13 Entropy Coder Metadata Structure When Sample Adaptive Entropy
Coder Is Used ............................................................................................................. 5-15
5-14 Entropy Coder Metadata Structure When Hybrid Entropy Coder Is Used ................ 5-16
5-15 Entropy Coder Metadata Structure When Block Adaptive Entropy
Coder Is Used ............................................................................................................. 5-16
5-16 Low-Entropy Code Input Symbol Limit and Threshold............................................. 5-23
A-1 Image Properties .......................................................................................................... A-5
A-2 Supplementary Information Table Features ................................................................ A-5
A-3 Prediction Calculation Features ................................................................................... A-6
A-4 Weight Initialization and Update Features .................................................................. A-7
A-5 Quantization Features .................................................................................................. A-8
A-6 Encoder Features ......................................................................................................... A-9
A-7 Header Elements .......................................................................................................... A-9
A-8 Sample-Adaptive Entropy Coder Features ................................................................ A-10
A-9 Hybrid Entropy Coder Features ................................................................................. A-10
A-10 Block-Adaptive Entropy Coder Features................................................................... A-10
B-1 Code Table for Low-Entropy Code 0 ...........................................................................B-2
B-2 Flush Table for Low-Entropy Code 0 ...........................................................................B-2
B-3 Code Table for Low-Entropy Code 1 ...........................................................................B-3
B-4 Flush Table for Low-Entropy Code 1 ...........................................................................B-4
B-5 Code Table for Low-Entropy Code 2 ...........................................................................B-4
B-6 Flush Table for Low-Entropy Code 2 ...........................................................................B-5
B-7 Code Table for Low-Entropy Code 3 ...........................................................................B-5
B-8 Flush Table for Low-Entropy Code 3 ...........................................................................B-6
B-9 Code Table for Low-Entropy Code 4 ...........................................................................B-6
B-10 Flush Table for Low-Entropy Code 4 ...........................................................................B-7
B-11 Code Table for Low-Entropy Code 5 ...........................................................................B-7
B-12 Flush Table for Low-Entropy Code 5 ...........................................................................B-8
B-13 Code Table for Low-Entropy Code 6 ...........................................................................B-8
B-14 Flush Table for Low-Entropy Code 6 ...........................................................................B-9
B-15 Code Table for Low-Entropy Code 7 ...........................................................................B-9
B-16 Flush Table for Low-Entropy Code 7 .........................................................................B-10
B-17 Code Table for Low-Entropy Code 8 .........................................................................B-10
B-18 Flush Table for Low-Entropy Code 8 .........................................................................B-11
B-19 Code Table for Low-Entropy Code 9 .........................................................................B-12
B-20 Flush Table for Low-Entropy Code 9 .........................................................................B-13
B-21 Code Table for Low-Entropy Code 10 .......................................................................B-14
B-22 Flush Table for Low-Entropy Code 10 .......................................................................B-15
B-23 Code Table for Low-Entropy Code 11 .......................................................................B-16
B-24 Flush Table for Low-Entropy Code 11 .......................................................................B-17
B-25 Code Table for Low-Entropy Code 12 .......................................................................B-17

CCSDS 123.0-B-2

Page viii

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

CONTENTS (continued)
Table

Page

B-26 Flush Table for Low-Entropy Code 12 .......................................................................B-17
B-27 Code Table for Low-Entropy Code 13 .......................................................................B-18
B-28 Flush Table for Low-Entropy Code 13 .......................................................................B-18
B-29 Code Table for Low-Entropy Code 14 .......................................................................B-18
B-30 Flush Table for Low-Entropy Code 14 .......................................................................B-18
B-31 Code Table for Low-Entropy Code 15 .......................................................................B-18
B-32 Flush Table for Low-Entropy Code 15 .......................................................................B-18
E-1 Coordinate Indices and Image Quantities ..................................................................... E-1
E-2 Predictor Quantities ...................................................................................................... E-1
E-3 Encoder Quantities........................................................................................................ E-3

CCSDS 123.0-B-2

Page ix

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

1

INTRODUCTION

1.1

PURPOSE

The purpose of this document is to establish a Recommended Standard for a data
compression algorithm applied to digital three-dimensional image data from payload
instruments, such as multispectral and hyperspectral imagers, and to specify the compressed
data format.
Data compression is used to reduce the volume of digital data to achieve benefits in areas
including, but not limited to,
a) reduction of transmission channel bandwidth;
b) reduction of the buffering and storage requirement; and
c) reduction of data-transmission time at a given rate.
1.2

SCOPE

The characteristics of instrument data are specified only to the extent necessary to ensure multimission support capabilities. The specification does not attempt to quantify the relative
bandwidth reduction, the merits of the approaches discussed, or the design requirements for
encoders and associated decoders. Some performance information is included in reference [D1].
This Recommended Standard addresses lossless and near-lossless compression of threedimensional data and provides a compression method that ensures that the distortion in the
reconstructed image does not exceed user-specified limits.
1.3

APPLICABILITY

This Recommended Standard applies to data compression applications of space missions
anticipating packetized telemetry cross support. In addition, it serves as a guideline for the
development of compatible CCSDS Agency standards in this field, based on good
engineering practice.
1.4

RATIONALE

The concept and rationale for the Low-Complexity Lossless and Near-Lossless Multispectral
and Hyperspectral Image Compression algorithm described herein may be found in
reference [D1].

CCSDS 123.0-B-2

Page 1-1

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

1.5

DOCUMENT STRUCTURE

This document is organized as follows:
a) Section 1 provides the purpose, scope, applicability, and rationale of this
Recommended Standard and identifies the conventions and references used
throughout the document. This section also describes how this document is
organized. A brief description is provided for each section and annex so that the
reader will have an idea of where information can be found in the document.
b) Section 2 provides an overview of the compressor.
c) Section 3 defines parameters and notation pertaining to an input image to be
compressed.
d) Section 4 specifies the predictor stage of the compressor.
e) Section 5 specifies the entropy coding stage of the compressor and the format of a
compressed image.
f) Annex A provides the Implementation Conformance Statement Requirements List for
implementations of this Recommended Standard.
g) Annex B lists code tables used by one of the entropy coding options.
h) Annex C discusses security, Space Assigned Numbers Authority (SANA), and patent
considerations.
i) Annex D lists informative references.
j) Annex E provides tables of symbols used in this document.
k) Annex F expands abbreviations and acronyms used in this document.
1.6

CONVENTIONS AND DEFINITIONS

1.6.1

MATHEMATICAL NOTATION AND DEFINITIONS

In this document, for any real number x, the largest integer n such that n ≤ x is denoted by
(1)

n =  x  ,

and correspondingly, the smallest integer n such that n ≥ x by
(2)

n =  x  ,

CCSDS 123.0-B-2

Page 1-2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

The modulus of an integer M with respect to a positive integer divisor n, denoted M mod n, is
defined to be
(3)

M mod n
= M M n  M / n .

When it is stated that a value M is encoded modulo n, this means the number M mod n is
encoded instead of M.
For any integer x and positive integer R, the function mod*R [ x] is defined as

((

)

)

1
mod*2 [ x ] =
x + 22 −−
mod 22 − 22 1 .

(4)

NOTE – The quantity mod*R [ x] is the R-bit two’s complement integer that is congruent to
x modulo 2R. This is a natural result of storing a signed integer x in an R-bit
register in two’s complement form when overflow might occur.
The notation clip ( x, { xmin , xmax }) denotes the clipping of the real number x to the range

[ x min , x max ] , that is,
 xmin , x < xmin

clip ( x, { xmin
, xmax })  x,
xmin ≤ x ≤ xmax .
=
x , x > x
max
 max

(5)

For any real number x, the function sgn(x) is defined as
x>0
1,

=
sgn( x) =
0, x 0 .
−1, x < 0


(6)

+

and the function sgn (x) is defined as
x≥0
1,
.
sgn + ( x) = 
−1, x < 0
1.6.2

NOMENCLATURE

1.6.2.1

Normative Text

(7)

The following conventions apply for the normative specifications in this Recommended
Standard:
a) the words ‘shall’ and ‘must’ imply a binding and verifiable specification;

CCSDS 123.0-B-2

Page 1-3

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

b) the word ‘should’ implies an optional, but desirable, specification;
c) the word ‘may’ implies an optional specification;
d) the words ‘is’, ‘are’, and ‘will’ imply statements of fact.
NOTE – These conventions do not imply constraints on diction in text that is clearly
informative in nature.
1.6.2.2

Informative Text

In the normative sections of this document (sections 3-5), informative text is set off from the
normative specifications either in notes or under one of the following subsection headings:
–

Overview;

–

Background;

–

Rationale;

–

Discussion.

1.6.3

CONVENTIONS

In this document, the following convention is used to identify each bit in an N-bit word. The
first bit in the word to be transmitted (i.e., the most left justified when drawing a figure) is
defined to be ‘bit 0’, the following bit is defined to be ‘bit 1’, and so on up to ‘bit N-1’.
When the word is used to express an unsigned binary value (such as a counter), the Most
Significant Bit (MSB), bit 0, shall correspond to the highest power of two, that is, 2N-1.
bit 0 bit 1

bit N-1

first transmitted bit = MSB

In accordance with modern data communications practice, spacecraft data words are often
grouped into 8-bit ‘words’ that conform to the above convention. Throughout this
Recommended Standard, the following nomenclature is used to describe this grouping:
8-bit word = ‘Byte’

CCSDS 123.0-B-2

Page 1-4

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

1.7

REFERENCE

The following publication contains provisions which, through reference in this text,
constitute provisions of this document. At the time of publication, the edition indicated was
valid. All publications are subject to revision, and users of this document are encouraged to
investigate the possibility of applying the most recent edition of the publication indicated
below. The CCSDS Secretariat maintains a register of currently valid CCSDS publications.
[1]

Lossless Data Compression. Issue 2. Recommendation for Space Data System
Standards (Blue Book), CCSDS 121.0-B-2. Washington, D.C.: CCSDS, May 2012.

NOTE – Non-normative references are contained in annex D.

CCSDS 123.0-B-2

Page 1-5

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

2

OVERVIEW

2.1

GENERAL

This Recommended Standard defines a payload data compressor that has applicability to
multispectral and hyperspectral imagers and sounders. This Recommended Standard does not
attempt to explain the theory underlying the compression algorithm; that theory is partially
addressed in reference [D1].
This Issue 2 revision extends the CCSDS Lossless Multispectral & Hyperspectral Image
Compression standard (reference [D2]) to provide an effective method of performing either
lossless or near-lossless compression of three-dimensional image data. Here, ‘near-lossless’
refers to the ability to perform compression in a way that the maximum error in the
reconstructed image can be limited to a user-specified bound. Key changes introduced in this
revision include the incorporation of a closed-loop quantization scheme to provide nearlossless compression and the extension of an entropy coding method of reference [D2] to
provide better compression of low-entropy data.
The input to the compressor is an image, which for the purposes of this Recommended
Standard is a three-dimensional array of integer sample values, as specified in section 3. The
compressed image output from the compressor is an encoded bitstream from which the input
image can be exactly or approximately reconstructed.
The compression method is capable of producing a reconstructed image meeting a fidelity
constraint specified by the user during compression, including lossless compression. A user
may vary fidelity settings from band to band and change these settings periodically within an
image.
For a given set of compression parameters, the length of the compressed image will vary
depending on image content. That is, the compressed image is variable-length. A user could
exploit the ability to adaptively vary fidelity settings within an image in an effort to meet a
constraint on compressed image data volume; techniques for performing this optimization are
outside the scope of this document. Reference [D1] presents some examples.
A user may choose to partition the output of an imaging instrument into multiple images that
are separately compressed, for example, to limit the impact of data loss or corruption on the
communications channel, or to limit the maximum possible size of a compressed image. This
Recommended Standard does not address such partitioning or the tradeoffs associated with
selecting the size of images produced under such partitioning. Reference [D1] presents some
examples.
Figure 2-1 depicts the components of the compressor defined in this Recommended
Standard. The compressor consists of a predictor followed by an encoder.

CCSDS 123.0-B-2

Page 2-1

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Figure 2-1: Compressor Schematic
The predictor, specified in section 4, uses an adaptive linear prediction method to predict the
value of each image sample based on the values of nearby samples in a small threedimensional neighborhood. Prediction is performed sequentially in a single pass.
The predictor makes use of an adaptively weighted prediction algorithm similar to the one
in reference [D2]. Compared to reference [D2], this Recommended Standard has some minor
changes in calculation of the prediction weights. More significantly, here the predictor
cannot in general utilize the exact values of the original sample values sz(t) because these
values will not be available to the decompressor at the time of reconstruction when
compression is not lossless. Instead, prediction calculations are performed using a sample
in place of each original sample value sz(t). The calculation of the
representative
sample representative is specified in 4.9.
The predictor in the present Recommended Standard also differs from that of reference [D2]
in that each prediction residual Δz(t), that is, the difference between the predicted and actual
sample values, is quantized using a uniform quantizer. The quantizer step size can be
controlled via an absolute error limit (so that samples can be reconstructed with a userspecified error bound) and/or a relative error limit (so that samples predicted to have smaller
magnitude can be reconstructed with lower error). Lossless compression in a band is
obtained simply by setting the absolute error limit to zero. The quantized prediction residual
qz(t) is mapped to an unsigned integer mapped quantizer index δz(t), similar to the calculation
of mapped prediction residuals in reference [D2]. These mapped quantizer indices make up
the output of the predictor.
The compressed image, specified in section 5, consists of a header that encodes image and
compression parameters followed by a body that is produced by an entropy coder, which
losslessly encodes the mapped quantizer indices. Entropy coder parameters are adaptively
adjusted during this process to adapt to changes in the statistics of the mapped quantizer
indices.

CCSDS 123.0-B-2

Page 2-2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

2.2

LOSSLESS COMPRESSION

Some simplification of the predictor arises when lossless compression is selected for the
quantizer fidelity control method. Specifically, the quantization calculation (4.8) becomes
trivial: qz(t) = Δz(t).
In addition, under lossless compression, in the sample representative calculation (4.9), the
offset parameter ѱz has no effect and is defined as zero; and if a user chooses to set the
damping parameter to zero, ϕz = 0, then the sample representatives are equal to the original
sample values, s′′z (t ) = sz (t ) . This simplification can facilitate the ability to perform pipelining
in a hardware implementation of the compressor.
It should be noted, however, that lossless compression performance may be improved by
using a nonzero value for the damping parameter ϕz in the sample representative calculation.
Reference [D1] includes additional discussion.
2.3

BACKWARDS COMPATIBILITY

The features and compressed image header structure of the present Recommended Standard
have been developed to ensure backwards compatibility with issue 1 of this Recommended
Standard specified in reference [D2], which provided only lossless compression.
Specifically, reference [D2] can be viewed as a restricted case of the present Recommended
Standard; a decompressor supporting all features of the present Recommended Standard
would be able to decompress a compressed image that is compliant with issue 1. However, it
should be noted that the additional features added in this issue are not limited to near-lossless
compression capabilities. Thus, for example, a losslessly compressed image that is compliant
with the present Recommended Standard might not be decompressible with a decompressor
that is compliant with issue 1.
Table 2-1 enumerates the constraints that would need to be imposed on an implementation of
this Recommended Standard to produce a compressor that is compliant with reference [D2].
Table 2-1: Backwards Compatibility with CCSDS-123.0-B-1
Reference
3.3.1

Limit dynamic range to D ≤ 16 bits.

3.5

Do not use supplementary information tables (set τ = 0).

4.4
4.8

Do not use narrow local sums.
Set the quantizer fidelity control method to be lossless (4.8.2.1.1).

CCSDS 123.0-B-2

Constraint

Page 2-3

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION
Reference
4.9, 5.3.3

Constraint
Set sample representative parameters to ϕz = ѱz = 0 for all z. Each

sample representative s′′z (t ) will be equal to sz(t). Set Θ = 0 so that the
Predictor Metadata header part does not include the Sample
Representative subpart.

4.10.3, 5.3.3.2 Set all weight exponent offsets ς z( i ) , ς z* to 0. In the Primary subpart of

5.4.3.2.3.4
5.4.3.3

2.4

the Predictor Metadata header part, set the Weight Exponent Offset
Flag to ‘0’.
If using the sample-adaptive entropy coder, do not use a rescaling
*
counter size parameter γ value larger than 9.
Do not use the hybrid entropy coder.

DATA TRANSMISSION

The effects of a small error or data loss event can propagate to corrupt an entire compressed
image (see reference [D1] for an example). Therefore, measures should be taken to minimize
errors and data loss in the compressed image.
This Recommended Standard does not incorporate sync markers or other mechanisms to flag
the header of an image; it is assumed that the transport mechanism used for the delivery of
the encoded bitstream will provide the ability to locate the beginning and end of a
compressed image and, in the event of data corruption, the header of the next image.
In case the encoded bitstream is to be transmitted over a CCSDS space link, several protocols
can be used to transfer a compressed image, including but not limited to
–

Space Packet Protocol (reference [D3]);

–

CCSDS File Delivery Protocol (CFDP) (reference [D4]); and

–

packet service as provided by the AOS Space Data Link Protocol (reference [D5]),
TM Space Data Link Protocol (reference [D6]), and Unified Space Data Link
Protocol (reference [D7]).

When transmission over a CCSDS space link occurs, application of one of the set of Channel
Coding and Synchronization Recommended Standards will significantly reduce the loss of
portions of transmitted data caused by data corruption.
Limits on the maximum size data unit that can be transmitted may be imposed by the
protocol used or by other practical implementation considerations. The user is expected to
take such limits into account when using this Recommended Standard.

CCSDS 123.0-B-2

Page 2-4

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

3

IMAGE

3.1

OVERVIEW

This section defines parameters and notation pertaining to an image. Quantities defined in
this section are summarized in table E-1 of annex E.
3.2

DIMENSIONS

3.2.1 An image is a three-dimensional array of signed or unsigned integer sample values
sz,y,x, where x and y are indices in the spatial dimensions, and the index z indicates the
spectral band.
NOTES
1

When spatially adjacent data samples are produced by different instrument detector
elements, changing values of the x index should correspond to changing detector
elements. Thus, for a typical push-broom imager, the x and y dimensions would
correspond to cross-track and along-track directions, respectively.

2

The spectral bands of the image need not be arranged in order of increasing or
decreasing wavelength. Rearranging the order of spectral bands can affect
compression performance. This Recommended Standard does not address the
tradeoffs associated with such a band reordering. Reference [D1] includes some
discussion of this topic.

3.2.2 Indices x, y, and z take on integer values in the ranges 0 ≤ x ≤ NX −1, 0 ≤ y ≤ NY −1,
and 0 ≤ z ≤ NZ −1, where each image dimension NX, NY, and NZ shall have a value of at least 1
and at most 216.
3.2.3 A frame Fy is defined as the sub-array of all image sample values with the same y
coordinate value; that is,
(8)

Fy (z, x) = sz,y,x for any 0 ≤ x ≤ NX −1, 0 ≤ z ≤ NZ −1.
3.3

DYNAMIC RANGE

3.3.1 Data samples shall have a fixed-size dynamic range of D bits, where D shall be an
integer in the range 2 ≤ D ≤ 32.
3.3.2 The quantities smin, smax, and smid denote the lower sample value limit, the upper
sample value limit, and a mid-range sample value, respectively. When samples are unsigned
integers, the values of smin, smax, and smid are defined as
D

D−1

smin = 0, smax = 2 −1, smid = 2

CCSDS 123.0-B-2

Page 3-1

(9)

,

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

and when samples are signed integers, the values of smin, smax, and smid are defined as
D−1

smin = −2
3.4

, smax = 2

D−1

−1, smid = 0.

(10)

SAMPLE COORDINATE INDICES

For notational simplicity, data samples and associated quantities may be identified either by
reference to the three indices x, y, z (e.g., sz,y,x, δz,y,x, etc.), or by the pair of indices t, z (e.g.,
sz(t), δz(t), etc.); that is,
sz(t) ≡ sz,y,x

(11)

δz(t) ≡ δz,y,x

(12)

t = y ∙ NX + x.

(13)

etc., where

NOTES
1

The value of t corresponds to the index of a sample within its spectral band when
samples in the band are arranged in raster-scan order, starting with index t=0.

2

Given t, the values of x and y can be computed as
x = t mod NX

(14)

y = t / N X  .

(15)

3.5

SUPPLEMENTARY INFORMATION TABLES

3.5.1

OVERVIEW

A user can choose to include up to 15 supplementary information tables to be encoded as
part of the compressed image. Each such table is a zero-dimensional (a single element), onedimensional (one element for each band z), or two-dimensional (one element for each (z, x)
pair, or each (y, x) pair) table of floating-point, signed integer, or unsigned integer value(s).
Such tables can be used to provide auxiliary image information to an end user, for example,
the wavelength associated with each spectral band, a band-dependent scaling factor to
convert reconstructed sample values to meaningful physical units, or a table identifying
defective elements of a detector array. When used, such tables are encoded in the image
header, as specified in 5.3.2.3.

CCSDS 123.0-B-2

Page 3-2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

3.5.2

SPECIFICATION

3.5.2.1 If supplementary information tables are used, the number of such tables, τ, shall be
at most 15.
3.5.2.2 For each supplementary information table, the user shall identify a purpose for the
table according to table 3-1. The ‘reserved’ purpose values are reserved for future use and
shall not be used.
Table 3-1: Supplementary Information Table Purpose
Purpose
0
1
2
3
4
5–9
10–15

Interpretation
scale
offset
wavelength
full width at half maximum
defect indicator
reserved
user-defined

NOTE – The purpose is intended to indicate how a decompressor or end user might
interpret the information in a supplementary information table. This does not
impose any requirements on post-processing operations to be performed
following decompression of an image.
3.5.2.3 Each supplementary information table type shall be unsigned integer, signed
integer, or float.
3.5.2.3.1 For an unsigned integer table, the user-specified table bit depth DI shall be an
integer in the range 1 ≤ DI ≤ 32, and each element of the table shall be an integer i in the
range 0 ≤ i ≤ 2 DI − 1 .
3.5.2.3.2 For a signed integer table, the user-specified table bit depth DI shall be an integer
in the range 1 ≤ DI ≤ 32, and each element of the table shall be an integer i in the range
1
−2 DI −−
≤ i ≤ 2 DI 1 − 1 .
3.5.2.3.3 For a float table, user-specified significand and exponent bit depths DF and DE
shall be integers in the range 1 ≤ DF ≤ 23, 2 ≤ DE ≤ 8, and the user-specified exponent bias β
shall be an integer in the range 0 ≤ β ≤ 2 DE − 1 . Each element of the table shall consist of a
sign bit b that is either 0 or 1, an exponent α that is an integer in the range 0 ≤ α ≤ 2 DE − 1 ,
and a significand j that is an integer in the range 0 ≤ j ≤ 2 DF − 1 . If the exponent α is 0, the
value represented is
(16)

β DF
.
(−1)β ⋅ j ⋅ 21−−

CCSDS 123.0-B-2

Page 3-3

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

If the exponent α is 2 DE − 1 , the value represented is non-numeric:
–

+∞ if b = 0 and j = 0;

–

−∞ if b = 1 and j = 0;

–

NaN (‘not a number’, an undefined or unrepresentable value) if j ≠ 0.

Otherwise, 0 < α < 2 DE − 1 , and the value represented is

(

)

(17)

β DF
.
(−1)β 2 DF + j 2α −−

NOTE – When DE = 8, DF = 23, and β = 127, the float table representation of values is the
same as the IEEE 754 single-precision binary floating-point format (binary32).
When DE = 5, DF = 10, and β = 15, the float table representation of values is the
same as the IEEE 754 half-precision binary floating-point format (binary16).
3.5.2.4 Each supplementary information table structure shall be zero-dimensional, onedimensional, two-dimensional-zx, or two-dimensional-yx.
3.5.2.4.1 A zero-dimensional signed or unsigned integer supplementary information table
consists of a single integer i.
3.5.2.4.2 A one-dimensional signed or unsigned integer supplementary information table
consists of NZ integers iz, for z = 0,…, NZ −1.
3.5.2.4.3 A two-dimensional-zx signed or unsigned integer supplementary information
table consists of NZ ∙ NX integers iz,x, for z = 0,…, NZ −1, x = 0,…, NX −1.
3.5.2.4.4 A two-dimensional-yx signed or unsigned integer supplementary information
table consists of NY ∙ NX integers iy,x, for y = 0,…, NY −1, x = 0,…, NX −1.
3.5.2.4.5 A zero-dimensional float supplementary information table consists of a single
element, defined by sign bit b, significand j, and exponent α.
3.5.2.4.6 A one-dimensional float supplementary information table consists of NZ elements,
each defined by sign bit bz, significand jz, and exponent αz, for z = 0,…, NZ −1.
3.5.2.4.7 A two-dimensional-zx float supplementary information table consists of NZ ∙ NX
elements, each defined by sign bit bz,x, significand jz,x, and exponent αz,x, for z = 0,…, NZ−1,
x = 0,…, NX−1.
3.5.2.4.8 A two-dimensional-yx float supplementary information table consists of NY ∙ NX
elements, each defined by sign bit by,x, significand jy,x, and exponent αy,x, for y = 0,…, NY −1,
x = 0,…, NX −1.

CCSDS 123.0-B-2

Page 3-4

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

4

PREDICTOR

4.1

OVERVIEW

This section specifies the calculation of the predicted sample values sˆz , y , x and mapped
quantizer indices δz,y,x from the input image samples sz,y,x. Quantities defined in this section
are summarized in table E-2 of annex E.
This Recommended Standard makes use of the same adaptively weighted predictor as
reference [D2], but to accommodate near-lossless compression, prediction calculations are
performed using sample representatives s′′z , y , x , defined in 4.9, in place of the original sample
values sz,y,x . This is necessary so that the decompressor can duplicate the prediction
calculation.
Prediction can be performed causally in a single pass through the image. Prediction at
sample sz,y,x , that is, the calculation of sˆz , y , x and δz,y,x , generally depends on the values of
sample representatives for nearby samples in the current spectral band and P preceding (i.e.,
lower-indexed) spectral bands, where P is a user-specified parameter (see 4.2). Figure 4-1
illustrates the typical neighborhood used for prediction; this neighborhood is suitably
truncated when y = 0, x = 0, x = NX – 1, or z < P.

Figure 4-1: Typical Prediction Neighborhood

CCSDS 123.0-B-2

Page 4-1

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Within each spectral band, the predictor computes a local sum of neighboring sample
representative values (see 4.4). Each such local sum is used to compute a local difference
(see 4.5). Predicted sample values are calculated using the local sum in the current spectral
band and a weighted sum of local difference values from the current and previous spectral
bands (see 4.7). The weights (see 4.6) used in this calculation are adaptively updated
(see 4.10) following the calculation of each predicted sample value. Each prediction
residual, that is, the difference between a given sample value sz,y,x and the corresponding
predicted sample value sˆz , y , x , is quantized (see 4.8) and then mapped to an unsigned integer
δz,y,x , the mapped quantizer index (see 4.11). The quantized value of sample sz,y,x is used to
calculate a corresponding sample representative value s′′z , y , x (see 4.9).
The local sum σz,y,x (see 4.4) is a weighted sum of sample representatives in spectral band z
that are adjacent to sample sz,y,x . Figure 4-2 illustrates the sample representatives used to
calculate the local sum. A user may choose to perform prediction using neighbor-oriented or
column-oriented local sums for an image, and local sums may be wide or narrow. When
neighbor-oriented local sums are used, the local sum is equal to a combination of up to four
neighboring sample representative values in the spectral band (except when y = 0, x = 0, or
x = NX –1, in which case these four values are not all available, and the local sum calculation
is suitably modified, as detailed in 4.4). When column-oriented local sums are used, the
local sum is equal to four times the neighboring sample representative value in the previous
row (except when y = 0, in which case this value is not available and the local sum
calculation is suitably modified as detailed in 4.4). Narrow local sums are defined to
eliminate the dependency on sample representative s′′z , y , x −1 when calculating σz,y,x , which
may facilitate pipelining in a hardware implementation.

1×

s"z,y−1,x−1

1×

s"z,y,x−1

1×

s"z,y−1,x

1×

s"z,y−1,x+1

s z,y,x

wide neighbororiented

1×

2×

s"z,y−1,x−1

s"z,y−1,x

s"z,y,x−1

s z,y,x

1×

s"z,y−1,x+1

narrow neighbororiented

4×

s"z,y−1,x−1

s"z,y−1,x

s"z,y,x−1

s z,y,x

s"z,y−1,x+1

column-oriented

Figure 4-2: Samples Used to Calculate Local Sums
The local sums are used to calculate local difference values. In each spectral band, the
central local difference, dz,y,x , is equal to the difference between the local sum σz,y,x and four
times the sample representative value s′′z , y , x (see 4.5.1). The three directional local
differences, dzN, y , x , dzW,y , x , and dzNW
, y , x , are each equal to the difference between σz,y,x and four
times a sample value labeled as ‘N’, ‘W’, or ‘NW’ in figure 4-3 (except when this sample
value is not available, that is, at image edges, as detailed in 4.5.2).

CCSDS 123.0-B-2

Page 4-2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

NW

N

s"z,y−1,x−1

s"z,y−1,x

W

central

s"z,y,x−1

s"z,y−1,x+1

s"z,y,x

Figure 4-3: Computing Local Differences in a Spectral Band
A user may choose to perform prediction for an image in full or reduced mode (see 4.3).
Under reduced mode, prediction depends on a weighted sum of the central local differences
computed in preceding bands; the directional local differences are not used, and thus need
not be calculated, under reduced mode. Under full mode, prediction depends on a weighted
sum of the central local differences computed in preceding bands and the three directional
local differences computed in the current band.
As described in reference [D1], the use of reduced mode in combination with columnoriented local sums tends to yield smaller compressed image data volumes for raw
(uncalibrated) input images from push-broom imagers that exhibit significant along-track
streaking artifacts. The use of full mode in combination with neighbor-oriented local sums
tends to yield smaller compressed image data volumes for whiskbroom imagers, frame
imagers, and calibrated imagery.
The prediction residual, the difference between the sample value sz,y,x and the predicted
sample value sˆz , y , x , is quantized (see 4.8), and the quantizer index is mapped to an unsigned
integer δz,y,x (see 4.11). This mapping is invertible, so that the decompressor can exactly
reconstruct the quantizer index. User-specified absolute and/or relative error limit values
(see 4.8) control the maximum error value mz(t) for each sample. Reconstruction of sample
sz,y,x with at most mz(t) units of error can be achieved by a decompressor. However, the
Recommended Standard imposes no specific requirements on reconstructing a sample by a
decompressor, and minimizing the maximum reconstruction error of each sample may not
minimize other distortion metrics (see reference [D1] for an example).
4.2

NUMBER OF BANDS FOR PREDICTION

The user-specified parameter P, which shall be an integer in the range 0 ≤ P ≤ 15, determines
the number of preceding spectral bands used for prediction. Specifically, prediction in
spectral band z depends on central local differences, defined in 4.5.1, computed in bands
z −−−
1, z 2,  , z Pz* , where
Pz* = min { z , P} .

CCSDS 123.0-B-2

Page 4-3

(18)

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

4.3

FULL AND REDUCED PREDICTION MODES

4.3.1 A user may choose to perform prediction using full or reduced mode for an image,
except when the image has width of one (i.e., NX = 1), in which case reduced mode shall be
used.
4.3.2 Under both full and reduced modes, prediction in spectral band z makes use of central
local differences from the preceding Pz* spectral bands. Under full prediction mode,
prediction in spectral band z additionally makes use of three directional local differences,
defined in 4.5.2, computed in the current spectral band z. Thus the number of local
difference values used for prediction at each sample in band z, denoted Cz , is
 Pz* ,
reduced prediction mode
.
Cz =  *
 Pz + 3, full prediction mode

4.4

(19)

LOCAL SUM

4.4.1 The local sum σz,y,x is an integer equal to a weighted sum of previous sample
representative values in band z that are neighbors of sample sz,y,x . A user may choose to
perform prediction using neighbor-oriented or column-oriented local sums for an image,
except when the image has width 1 (i.e., NX = 1), in which case column-oriented local sums
shall be used. In either case, a user may choose to use wide or narrow local sums.
NOTE – Column-oriented local sums are not suggested under full prediction mode.
4.4.2

When wide neighbor-oriented local sums are used, σz,y,x is defined as
′′
′′
′′
y > 0, 0 < x < N X − 1
 s′′z , y , x −−−−−
1 + s z , y 1, x 1 + s z , y 1, x + s z , y 1, x +1 ,
4 s′′
y 0, x > 0
=
 z , y , x −1 ,
;
s z, y,x = 
′′ 1, x + s′′z , y 1, x +1 ) ,
0
y > 0, x =
2 ( sz , y −−
 s′′
′′
′′
y > 0, x = N X − 1
1 + s z , y 1, x 1 + 2 s z , y 1, x ,
 z , y , x −−−−

(20)

when narrow neighbor-oriented local sums are used, σz,y,x is defined as
′′
′′
 s′′z , y −−−−
1, x 1 + 2 s z , y 1, x + s z , y 1, x +1 ,
4 s′′
1, y , x 1 ,
 z −−

′′
s z , y , x = 2 ( s′′z , y −−
1, x + s z , y 1, x +1 ) ,

′′
1, x 1 + s z , y 1, x ) ,
2 ( s′′z , y −−−
4s ,
 mid

CCSDS 123.0-B-2

Page 4-4

y > 0, 0 < x < N X − 1
y = 0, x > 0, z > 0
y > 0, x =
0

;

(21)

y > 0, x = N X − 1
y = 0, x > 0, z = 0

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

when wide column-oriented local sums are used, σz,y,x is defined as
4 s′′z , y −1, x , y > 0
;
y 0, x > 0
4 s′′z , y , x −1 , =

(22)

s z, y,x = 

and when narrow column-oriented local sums are used, σz,y,x is defined as
 4 s′′z , y −1, x ,

s z , y , x = 4s′′z −−
1, y , x 1 ,
 4s ,
mid


y>0
y = 0, x > 0, z > 0 ,
y = 0, x > 0, z = 0

(23)

where sample representative values s′′z , y , x are defined in 4.9.
NOTE – The value of σz,0,0 is not defined, as it is not needed.
4.5

LOCAL DIFFERENCES

4.5.1

CENTRAL LOCAL DIFFERENCE

When x and y are not both zero (i.e., when t > 0), the central local difference dz,y,x is defined as
(24)

dz,y,x = 4 s′′z , y , x – σz,y,x .
4.5.2

DIRECTIONAL LOCAL DIFFERENCES

When x and y are not both zero (i.e., when t > 0), the three directional local differences are
defined as
− s z, y,x ,
4 s′′
d zN,y , x =  z , y −1, x
0,

d

W
z, y,x

d

y>0
,
y=0

(25)

4 s′′z , y , x −1 − s z , y , x , x > 0, y > 0

=
0, y 0 , and
4 s′′z , y −1, x − s z , y , x , x =>
0,
y=0


(26)

x > 0, y > 0
4 s′′z , y −−
1, x 1 − s z , y , x ,

=
x=
0, y > 0 .
4 s′′z , y −1, x − s z , y , x ,
0,
y=0


(27)

NW
z, y,x

NOTE – Directional local differences are not used under reduced prediction mode.

CCSDS 123.0-B-2

Page 4-5

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

4.5.3

LOCAL DIFFERENCE VECTOR

For t > 0, the local difference vector U z (t ) is a vector of the Cz local difference values used to
calculate the predicted sample value sˆz (t ) . Under full prediction mode, U z (t ) is defined as
 d zN (t ) 
 W

 d z (t ) 
 d zNW (t ) 


U z (t ) =  d z −1 (t )  ,
 d (t ) 
 z −2 
  
 d (t ) 
 z − Pz* 

(28)

and under reduced prediction mode, for z > 0, U z (t ) is defined as
 d z −1 (t ) 
 d (t ) 
z −2
.
U z (t ) = 
  


 d z − Pz* (t ) 

(29)

NOTE – Under reduced mode, U 0 (t ) is not defined, as it is not needed.
4.6

WEIGHTS

4.6.1

WEIGHT VALUES AND WEIGHT RESOLUTION

4.6.1.1 In the prediction calculation (see 4.7), for t > 0, each component of the local
difference vector U z (t ) is multiplied by a corresponding integer weight value.
4.6.1.2 The resolution of the weight values is controlled by the user-specified parameter Ω,
which shall be an integer in the range 4 ≤ Ω ≤ 19.
4.6.1.3 Each weight value is a signed integer quantity that can be represented using Ω + 3
bits. Thus each weight value has minimum and maximum possible values ωmin and ωmax,
respectively, where
Ω+2

ωmin = −2

CCSDS 123.0-B-2

, ωmax = 2

Page 4-6

Ω+2

(30)

−1.

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

NOTE – Increasing the number of bits used to represent weight values (i.e., using a larger
value of Ω) provides increased resolution in the prediction calculation. This
Recommended Standard does not address the tradeoffs associated with selecting
the value of Ω. Reference [D1] presents some examples.
4.6.2

WEIGHT VECTOR

The weight vector Wz (t ) is a vector of the Cz weight values used in prediction. Under full
prediction mode,
 ω zN (t ) 
 W 
 ω z (t ) 
ω zNW (t ) 
 (1) 
Wz (t ) =  ω z (t )  ,
 ω (2) (t ) 
 z

  
 ( Pz* ) 
ω z (t ) 

(31)

and under reduced prediction mode, for z > 0,
 ω z(1) (t ) 
 (2) 
ω z (t ) 
Wz (t ) = 
,
  
 * 
ω z( Pz ) (t ) 

(32)

where the weight values are calculated as specified in 4.6.3 and 4.10.
NOTE – Under reduced mode, W0 (t ) is not defined as it is not needed.
4.6.3
4.6.3.1

INITIALIZATION
General

A user may choose to use either default or custom weight initialization, defined below, to
select the initial weight vector Wz (1) for each spectral band z. The same weight
initialization method shall be used for all spectral bands.

CCSDS 123.0-B-2

Page 4-7

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

4.6.3.2

Default Weight Initialization

4.6.3.2.1 When default weight initialization is used, for each spectral band z, initial weight
*
vector components ω z(1) (1) , ω z(2) (1) , …, ω z( Pz ) (1) , shall be assigned values
=
ω z(1) (1)

7 Ω
 1 (i −1) 
=
ω z (1)  , i 2,3, , Pz* .
2 , ω z(i ) (1) =
8
8


(33)

4.6.3.2.2 With this option, under full prediction mode the remaining components of Wz (1)
shall be assigned values
(34)

N
W
ω=
ω=
ω zNW
=
(1) 0 .
z (1)
z (1)

4.6.3.3

Custom Weight Initialization

4.6.3.3.1 When custom weight initialization is used, for each spectral band z, the initial
weight vector Wz (1) shall be assigned using a user-specified weight initialization vector Λz,
consisting of Cz signed Q-bit integer components.
NOTES
1

The weight initialization vector Λz may be encoded in the header as described in 5.3.

2

A weight initialization vector Λz might be selected based on instrument
characteristics or training data, or might be selected based on a weight vector from a
previous compressed image.

4.6.3.3.2 The weight initialization resolution Q shall be a user-specified integer in the
range 3 ≤ Q ≤ Ω + 3 bits.
4.6.3.3.3

The initial weight vector Wz (1) shall be calculated from Λz by
(35)

2Ω+3−Q Λ z +  2Ω+ 2−Q − 1 1 ,
Ω=
z (1)

where 1 denotes a vector of all ‘ones’.
NOTE – In the (Ω + 3)-bit two’s complement representation of each component of Wz (1) ,
the Q MSBs are equal to the binary representation of the corresponding
component of Λz. The remaining bits, if any, are made up of a ‘0’ bit followed
by ‘1’ bits in the remaining positions.

CCSDS 123.0-B-2

Page 4-8

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

4.7

PREDICTION CALCULATION

4.7.1 For t > 0, the predicted central local difference dˆz (t ) is equal to the inner product of
vectors Wz (t ) and U z (t ) :
dˆz (t ) = WzT (t )U z (t ) ,

(36)

except for z = 0 under reduced mode, in which case dˆz (t ) = 0 .
4.7.2


The high-resolution predicted sample value, sz (t ) , is calculated as

(

})


=
sz (t ) clip mod*R  dˆz (t ) + 2Ω (s z (t ) − 4 smid )  + 2Ω+ 2 smid + 2Ω+1 , 2Ω+ 2 smin , 2Ω+ 2 smax + 2Ω+1 , (37)



{

where the user-selected register size parameter R shall be an integer in the range
max{32, D + Ω + 2} ≤ R ≤ 64.
NOTE – Increasing the register size R reduces the chance of an overflow occurring in the
calculation of a high-resolution predicted sample value. This Recommended
Standard does not address the tradeoffs associated with selecting the value of R.
Reference [D1] provides some discussion.
4.7.3

The double-resolution predicted sample value is

  sz (t ) 
  2Ω+1  , t > 0

 
.
sz (t ) = 2sz −1 (t ), t = 0, P > 0, z > 0
2s , =
=
t 0 and
( P 0=
or z 0)
 mid


4.7.4

(38)

The predicted sample value sˆz (t ) is defined as
 s (t ) 
sˆz (t ) =  z  .
 2 

CCSDS 123.0-B-2

Page 4-9

(39)

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

4.8

QUANTIZATION

4.8.1

QUANTIZER OUTPUT

The prediction residual Δz(t) is the difference between the predicted and actual sample
values,
(40)

∆ z (t ) = sz (t ) − sˆz (t ) .
The prediction residual shall be quantized using a uniform quantizer with step size
2mz(t) + 1, producing as quantizer output the signed integer quantizer index qz(t), defined as

t=
0
∆ z (0),

(41)
qz (t ) = 
,
 ∆ z (t ) + mz (t ) 
∆
>
t
t
sgn(
(
))
,
0


z

 2mz (t ) + 1 

where the maximum error value mz(t) is determined via user-specified quantizer fidelity
settings as specified in 4.8.2.
NOTE – Given qz(t), reconstruction of sample sz(t) with no more than mz(t) units of error
is possible. Thus lossless compression is achieved for this sample when mz(t) = 0.
4.8.2

FIDELITY CONTROL

4.8.2.1

Controlling Maximum Error

4.8.2.1.1 For a given image, a user may choose the quantizer fidelity control method to be
lossless, in which case
(42)

mz(t) = 0
for all z and t. Otherwise, the user may control the maximum error value mz(t) by specifying
an absolute error limit az for each z, a relative error limit rz for each z, or both.
NOTE – Restrictions on allowed error limit values are specified in 4.8.2.2.
4.8.2.1.2

When only absolute error limits are used, the maximum error shall be computed as
(43)

mz(t) = az
for all z and t; when only relative error limits are used,
 r sˆ (t ) 
mz (t ) =  z zD 
 2


CCSDS 123.0-B-2

Page 4-10

(44)

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

for all z and t; and when both absolute and relative error limits are used,

  r sˆ (t )  
mz (t ) = min  az ,  z zD  



  2

(45)

for all z and t.
4.8.2.2

Allowed Error Limit Values

4.8.2.2.1 If absolute error limits are used, then for each spectral band z, the value of az shall
be an integer in the range 0 ≤ az ≤ 2 DA − 1 , where the user-specified absolute error limit bit
depth DA shall be an integer in the range 1 ≤ DA ≤ min{D −1,16}.
4.8.2.2.2 If relative error limits are used, then for each spectral band z, the value of rz shall
be an integer in the range 0 ≤ rz ≤ 2 DR − 1 , where the user-specified relative error limit bit
depth DR shall be an integer in the range 1 ≤ DR ≤ min{D −1,16}.
4.8.2.3

Error Limit Assignment Methods

4.8.2.3.1 If used, absolute error limits shall be either (a) band-dependent, in which case the
N −1
user shall specify a set of absolute error limit values {az }z =Z0 , or (b) band-independent, in
*

*

which case az = A for each spectral band z, where A shall be the user-specified integer
absolute error limit constant, satisfying 0 ≤ A* ≤ 2 DA − 1 .
4.8.2.3.2 If used, relative error limits shall be either (a) band-dependent, in which case the
N −1
user shall specify a set of relative error limit values {rz }z =Z0 , or (b) band-independent, in
*

*

which case rz = R for each spectral band z, where R shall be the user-specified integer
relative error limit constant, satisfying 0 ≤ R* ≤ 2 DR − 1 .
NOTE – When both absolute and relative error limits are used for an image, the choice of
assignment methods for relative and absolute error limits need not be the same.
That is, band-independent absolute error limits may be used in combination with
band-dependent relative error limits, and vice-versa.

CCSDS 123.0-B-2

Page 4-11

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

4.8.2.4

Periodic Error Limit Updating

4.8.2.4.1 When used, error limit values may be fixed for an entire image, or the user may
choose to use periodic error limit updating, in which case error limit values are periodically
updated.
4.8.2.4.2 When periodic error limit updating is used, the user shall provide error limit
u
values every 2 frames, where the user-specified error limit update period exponent u shall
be an integer in the range 0 ≤ u ≤ 9.
4.8.2.4.3 All other quantizer fidelity settings (choice to use absolute and/or relative error
limits, choice between band-dependent and band-independent assignment methods for the
error limit method[s] in use, and error limit bit depth[s]) shall be fixed for the entire image.
4.8.2.4.4 Periodic error limit updating shall not be used with Band-SeQuential (BSQ) input
order (defined in 5.4.2.3).
4.9

SAMPLE REPRESENTATIVES

4.9.1 Sample representatives are calculated using user-specified resolution parameter Θ,
which shall be an integer in the range 0 ≤ Θ ≤ 4, and for each spectral band z, parameters
damping, ϕz , and offset, ѱz .
4.9.1.1

Θ

Each ϕz shall be a user-specified integer in the range 0 ≤ ϕz ≤ 2 −1.
Θ

4.9.1.2 Each ѱz shall be a user-specified integer in the range 0 ≤ ѱz ≤ 2 −1, unless lossless
fidelity control is used, in which case ѱz = 0.
4.9.2 The sample representative s′′z (t ) , which has the same resolution as the original
samples, shall be calculated as
t =0
 sz (0),

s′′z (t ) =  s′′z (t ) + 1 
 2  , t > 0



(46)

from the double-resolution sample representative
 4 2Θ − φz ⋅ s′z (t ) ⋅ 2Ω − sgn(qz (t )) ⋅ mz (t ) ⋅ψ z ⋅ 2Ω−Θ + φz ⋅ sz (t ) − φz ⋅ 2Ω+1 
,
s′′z (t ) = 
2Ω+Θ+1



(

)(

)


where sz (t ) is the high-resolution predicted sample value defined in 4.7.2, and

CCSDS 123.0-B-2

Page 4-12

February 2019

(47)

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

s′z (t ) =
clip ( sˆz (t ) + qz (t ) ( 2mz (t ) + 1) ,{smin , smax })

(48)

is a clipped version of the quantizer bin center.
NOTES
1

Reconstructing sample sz(t) with value s′z (t ) by the decompressor ensures that
reconstruction error will be at most mz(t). If mz(t) = 0 then s′z (t ) = sz (t ) .

2

Setting ϕz = ѱz = 0 causes the sample representative s′′z (t ) to be equal to s′z (t ) .

3

The difference between the sample representative s′′z (t ) and the predicted sample
value sˆz (t ) may exceed mz(t).

4.10 WEIGHT UPDATE
4.10.1 The double-resolution prediction error ez(t) is an integer defined as
(49)

=
ez (t ) 2 s′z (t ) − sz (t ) .
4.10.2 For t > 0, the weight update scaling exponent ρ(t) is an integer defined as



 t − NX 
ρ (t ) clip n min + 
n
n
,
,
=
{
}


min
max  + D − Ω ,
 tinc 



(50)

where user-specified integer parameters vmin, vmax, and tinc are constrained as follows:
a) The values of vmin and vmax shall be integers in the range –6 ≤ vmin ≤ vmax ≤ 9.
b) The weight update scaling exponent change interval tinc shall be a power of 2 in the
4
11
range 2 ≤ tinc ≤ 2 .
NOTE – These parameters control the rate at which weights adapt to image data statistics.
The initial weight update scaling exponent is ρ(1) = vmin + D − Ω, and at regular
intervals determined by the value of tinc , ρ(t) is incremented by one until reaching
a final value vmax + D − Ω. Smaller values of ρ(t) produce larger weight
increments, yielding faster adaptation to source statistics but worse steady-state
compression performance.
4.10.3 For t > 0, following the calculation of sz (t ) , components of the next weight vector in
the spectral band, Wz (t + 1) , are defined as

CCSDS 123.0-B-2

Page 4-13

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION



1


(

(i )
clip  ω z(i ) (t ) +  sgn + [ ez (t ) ] ⋅ 2
ω=
z (t + 1)
2



(

− ρ ( t ) +ς z( i )

)


) ⋅ d (t ) + 1  , ω , ω
z −i
 { min max }  ,

(51)



and, when full prediction mode is used, for the directional components,









(52)


) ⋅ d W (t ) + 1  , ω , ω
z
 { min max }  ,

)



(53)

)

(54)

− ρ ( t ) +ς *z

1


(

− ρ ( t ) +ς *z

1


(

− ρ ( t ) +ς *z

(

NW
ω=
(t + 1) clip  ω zNW (t ) +  sgn + [ ez (t ) ] ⋅ 2
z
2



)

(

W
clip  ω zW (t ) +  sgn + [ ez (t ) ] ⋅ 2
ω=
z (t + 1)
2




) ⋅ d N (t ) + 1  , ω , ω
z
 { min max }  ,

1


N
ω=
clip  ω zN (t ) +  sgn + [ ez (t ) ] ⋅ 2
z (t + 1)
2

(

(


) ⋅ d NW (t ) + 1  , ω , ω
z
 { min max }  .


4.10.4 The inter-band weight exponent offsets ς z(i ) , for z = 0,…, NZ −1 and i = 1,..., Pz* , and
intra-band weight exponent offsets ς z* shall be user-specified integers in the range

−6 ≤ ς z(i ) ≤ 5 and −6 ≤ ς z* ≤ 5 , respectively.
1

+
− ( ρ ( t ) +z )
is
equivalent
to
⋅ d +1 
 2 sgn [ ez (t ) ] ⋅ 2

1

+
− ( ρ ( t ) +z )
⋅ d  + 1  but is not in general equivalent to
 2 sgn [ ez (t ) ] ⋅ 2

1

+
− ( ρ ( t ) +z )
⋅ d  + 1  .
 2 sgn [ ez (t ) ] ⋅  2


NOTE – The

quantity

(

)

(

)

(

)

4.11 MAPPED QUANTIZER INDEX
The signed quantizer index qz(t) is converted to an unsigned mapped quantizer index δz(t)
defined as
 qz (t ) + q z (t ), qz (t ) > q z (t )

=
δ z (t ) 2 qz (t ) ,
0 ≤ (−1) sz (t ) qz (t ) ≤ q z (t ) ,

otherwise
2 qz (t ) − 1,

(55)

min {sˆz (0) −−
smin , smax sˆz (0)}
t=
0

.
θ z (t ) = 
  sˆz (t ) − smin + mz (t )   smax − sˆz (t ) + mz (t )  
, 
, t > 0
min  
2mz (t ) + 1
2mz (t ) + 1
 
 
 


(56)

where

NOTE – Each mapped quantizer index δz(t) can be represented as a D-bit unsigned integer.

CCSDS 123.0-B-2

Page 4-14

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5

ENCODER

5.1

OVERVIEW

This section specifies the encoding stage of the compressor and the format of a compressed
image. Quantities defined in this section are summarized in table E-3 of annex E.
A compressed image consists of a header followed by a body.
The variable-length header, defined in 5.3, encodes image and compression parameters.
The body, defined in 5.4, losslessly encodes mapped quantizer indices δz,y,x from the
predictor. If the periodic error limit updating option is used (see 4.8.2.4), then error limit
values are also periodically encoded as part of the body.
A user can choose to perform encoding using the sample-adaptive entropy coding approach
specified in 5.4.3.2, the hybrid approach specified in 5.4.3.3, or the block-adaptive approach
specified in 5.4.3.4.
The sample-adaptive and block-adaptive entropy coding approaches are the same as the ones
specified in reference [D2]. They are generally effective for lossless compression, but the
ability to use near-lossless compression under the present Recommended Standard tends to
yield mapped quantizer indices having a lower-entropy distribution. The hybrid encoding
approach tends to provide more effective encoding for lower-entropy distributions. Examples
and comparisons can be found in reference [D1].
Under the sample-adaptive entropy coding approach, each mapped quantizer index is
encoded using a variable-length binary codeword from a family of codes. Which member of
this family is used is adaptively selected based on statistics that are updated after each
sample is encoded; separate statistics are maintained for each spectral band, and the
compressed image size does not depend on the order in which mapped quantizer indices are
encoded.
Like the sample-adaptive coder, the hybrid entropy coding approach uses similar adaptive
code selection statistics. It includes codes equivalent to those used by the sample-adaptive
encoder, but augmented with an additional 16 variable-to-variable length ‘low-entropy’
codes. A single output codeword from a low-entropy code may encode multiple mapped
quantizer indices, allowing lower compressed data rates than can be achieved by the ‘highentropy’ codes. The order in which mapped quantizer indices are encoded has virtually no
impact on compressed image size.
The block-adaptive entropy coding approach relies on the lossless data compressor defined
in reference [1]. Under this approach, the sequence of mapped quantizer indices is
partitioned into short blocks, and the encoding method used is independently and adaptively
selected for each block. Depending on the encoding order, the mapped quantizer indices in a
block may be from the same or different spectral bands, and thus the compressed image size
depends on the encoding order when this approach is used.

CCSDS 123.0-B-2

Page 5-1

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.2

GENERAL

5.2.1 A compressed image shall consist of a variable-length header, defined in 5.3,
followed by a variable-length body, defined in 5.4.
NOTE – Figure 5-1 depicts the structure of a compressed image.

Figure 5-1: Compressed Image Structure
5.2.2 The user-selected output word size, measured in bytes, shall be an integer B in the
range 1 ≤ B ≤ 8.
NOTE – Fill bits are included in the body (as specified in 5.4.3.2.4.4, 5.4.3.4.3.2, and
5.4.3.3.5.4.5) when needed to ensure that the size of the compressed image is a
multiple of the output word size.
5.3

HEADER

5.3.1

GENERAL

5.3.1.1

The header of a compressed image shall have the structure specified in table 5-1.
Table 5-1: Header Structure
Part
Image Metadata
Predictor Metadata
Entropy Coder Metadata

Status
Mandatory
Mandatory
Mandatory

Size
Variable
Variable
Variable

Reference
5.3.2
5.3.3
5.3.4

NOTES
1

The length of each header part varies depending on compression options selected by
the user.

2

Each header part consists of an integer number of bytes. The header length is not
necessarily a multiple of the output word size.

5.3.1.2

Whenever fill bits are included in a header element, fill bits shall be all zeros.

CCSDS 123.0-B-2

Page 5-2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.2

IMAGE METADATA

5.3.2.1

Header

The Image Metadata header part shall have the structure specified in table 5-2.
Table 5-2: Image Metadata Structure
Subpart
Essential
Supplementary Information Tables

5.3.2.2

Status
Mandatory
Optional

Size (Bytes)
12
Variable

Reference
5.3.2.2
5.3.2.3

Essential

The Essential subpart shall have the structure specified in table 5-3.
Table 5-3: Essential Subpart Structure
Field
User-Defined
Data
X Size

Width
Description
(bits)
8 The user may assign the value of this field arbitrarily, for
example, to indicate the value of a user-defined index of the
image within a sequence of images.
16 The value N encoded mod 216 as a 16-bit unsigned binary
integer.

Reference

3.2

X

Y Size

16

The value NY encoded mod 216 as a 16-bit unsigned binary
integer.

3.2

Z Size

16

3.2

Sample Type

1

Reserved
Large Dynamic
Range Flag

1
1

The value NZ encoded mod 216 as a 16-bit unsigned binary
integer.
‘0’: image sample values are unsigned integers.
‘1’: image sample values are signed integers.
This field shall have value ‘0’.
‘0’: dynamic range satisfies D ≤ 16.
‘1’: dynamic range satisfies D > 16.

3.3

Dynamic Range

4

The value D mod 24 as a 4-bit unsigned binary integer.

3.3

Sample
Encoding Order
Sub-Frame
Interleaving
Depth

1

5.4.2

16

Reserved

2

‘0’: samples are encoded in band-interleaved order.
‘1’: samples are encoded in BSQ order.
When band-interleaved encoding order is used, this field shall
contain the value M encoded mod 216 as a 16-bit unsigned
binary integer.
When BSQ encoding order is used, this field shall be all
‘zeros’.
This field shall have value ‘00’.

CCSDS 123.0-B-2

Page 5-3

3.2.1

5.4.2.2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION
Field
Output Word
Size
Entropy Coder
Type
Reserved
Quantizer
Fidelity Control
Method
Reserved
Supplementary
Information
Table Count

5.3.2.3
5.3.2.3.1

Width
Description
(bits)
3 The value B encoded mod 23 as a 3-bit unsigned binary
integer.
2 ‘00’: sample-adaptive entropy coder is used.
‘01’: hybrid entropy coder is used.
‘10’: block-adaptive entropy coder is used.
1 This field shall have value ‘0’.
2 ‘00’: lossless.
‘01’: absolute error limit only.
‘10’: relative error limit only.
‘11’: both absolute and relative error limits.
2 This field shall contain all ‘zeros’.
4 The value τ, encoded as a 4-bit unsigned integer.

Reference
5.2.2
5.4.3

4.8.2.1

3.5.2.1

Supplementary Information Tables
General

5.3.2.3.1.1 The Supplementary Information Tables subpart shall be present when the
number of supplementary information tables, τ, is nonzero and shall be omitted otherwise.
5.3.2.3.1.2 When present, the Supplementary Information Tables subpart shall consist of a
sequence of τ Supplementary Information Tables, each having the structure specified in
table 5-4.
Table 5-4: Supplementary Information Table Structure
Field
Table Type
Reserved
Table Purpose
Reserved
Table Structure

Reserved
Supplementary
User-Defined
Data
Table Data
Subblock

CCSDS 123.0-B-2

Width (bits)
Description
Reference
2 ‘00’: unsigned integer.
3.5.2.3
‘01’: signed integer.
‘10’: float.
2 This field shall have value ‘00’.
4 Table purpose value encoded as a 4-bit 3.5.2.2
unsigned integer (see table 3-1).
1 This field shall have value ‘0’.
2 ‘00’: zero-dimensional.
3.5.2.4
‘01’: one-dimensional.
‘10’: two-dimensional-zx.
‘11’: two-dimensional-yx.
1 This field shall have value ‘0’.
4 The user may assign the value of this
field arbitrarily.
(variable)

(See 5.3.2.3.2 below.)

Page 5-4

3.5

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.2.3.2

Table Data Subblock

5.3.2.3.2.1 A Table Data subblock shall have the structure specified in 5.3.2.3.2.2 when the
table type is unsigned or signed integer, and the structure specified in 5.3.2.3.2.3 when the
table type is float.
5.3.2.3.2.2 If the Table Type is signed or unsigned integer, then the Table Data subblock
shall consist of
a) the value of the table bit depth DI encoded modulo 25 as a 5-bit unsigned integer (5
bits);
b) the sequence of table elements (DI bits each):
1) if the table structure is zero-dimensional, then the single value i is encoded;
2) if the table structure is one-dimensional, then each iz is encoded in order of
increasing index z;
3) if the table structure is two-dimensional-zx, then each iz,x is encoded in the order
defined by the nesting of loops as follows:
for z = 0 to NZ −1
for x = 0 to NX −1
encode iz,x ;
4) if the table structure is two-dimensional-yx, then each iy,x is encoded in the order
defined by the nesting of loops as follows:
for y = 0 to NY −1
for x = 0 to NX −1
encode iy,x ;
5) each table element, i, iz , iz,x , or iy,x , is encoded as a DI-bit unsigned binary integer,
or in two’s complement representation for table types unsigned integer and signed
integer, respectively; and
c) fill bits appended as needed to reach the next byte boundary.
5.3.2.3.2.3

If the Table Type is float, then the Table Data subblock shall consist of

a) the value of the significand bit depth DF encoded as a 5-bit unsigned integer (5 bits);
b) the value of the exponent bit depth DE encoded mod 23 as a 3-bit unsigned integer (3
bits);
c) the value of the exponent bias β encoded as an DE-bit unsigned integer (DE bits);
d) the sequence of table elements (1 + DF + DE bits each):

CCSDS 123.0-B-2

Page 5-5

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

1) if the table structure is zero-dimensional, then the single table element {b, α, j} is
encoded;
2) if the table structure is one-dimensional, then table elements {bz , αz , jz } are
encoded in the following order:
for z = 0 to NZ −1
encode {bz , αz , jz };
3) if the table structure is two-dimensional-zx, then table elements {bz,x , αz,x , jz,x } are
encoded in the order defined by the nesting of loops as follows:
for z = 0 to NZ −1
for x = 0 to NX −1
encode {bz,x , αz,x , jz,x };
4) if the table structure is two-dimensional-yx, then table elements {by,x , αy,x , jy,x }
are encoded in the order defined by the nesting of loops as follows:
for y = 0 to NY −1
for x = 0 to NX −1
encode {by,x , αy,x , jy,x };
5) for each table element {b, α, j}, {bz , αz , jz }, {bz,x , αz,x , jz,x }, or {by,x , αy,x , jy,x },
the following are encoded:
i) the value of the sign bit (1 bit);
ii) the value of the exponent, encoded as a DE-bit unsigned integer (DE bits);
iii) the value of the significand, encoded as an DF-bit unsigned integer (DF bits); and
e) fill bits appended as needed to reach the next byte boundary.
5.3.3
5.3.3.1

PREDICTOR METADATA
Header

The Predictor Metadata header part shall have the structure specified in table 5-5.
Table 5-5: Predictor Metadata Structure
Subpart
Primary
Weight Tables
Quantization
Sample Representative

CCSDS 123.0-B-2

Status
Mandatory
Optional
Conditional
Conditional

Page 5-6

Size (Bytes)
5
Variable
Variable
Variable

Reference
5.3.3.2
5.3.3.3
5.3.3.4
5.3.3.5

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.3.2

Primary

The Primary subpart shall have the structure specified in table 5-6.
Table 5-6: Primary Structure
Field
Reserved
Sample
Representative
Flag

Number of
Prediction Bands
Prediction Mode

Width
Description
(bits)
1
This field shall have value ‘0’.
1
‘0’: Sample Representative subpart is not included in
Predictor Metadata header part; sample representatives
use ϕz = ѱz = 0 for all spectral bands z.
‘1’: Sample Representative subpart is included in
Predictor Metadata header part.
4
The value P encoded as a 4-bit unsigned binary integer.
1

Weight Exponent
Offset Flag

1

Local Sum Type

2

Register Size

6

Weight Component
Resolution
Weight Update
Scaling Exponent
Change Interval
Weight Update
Scaling Exponent
Initial Parameter
Weight Update
Scaling Exponent
Final Parameter
Weight Exponent
Offset Table Flag

4

Weight Initialization
Method
Weight Initialization
Table Flag

1

Weight Initialization
Resolution

5

CCSDS 123.0-B-2

Reference
4.9

4.2

‘0’: full prediction mode is used.
‘1’: reduced prediction mode is used.
‘0’: all ς z

(i )

4.3
4.10.3

and ς z values are zero.
*

‘1’: some ς z

(i )

and ς z values may be nonzero.
*

‘00’: wide neighbor-oriented local sums are used.
‘01’: narrow neighbor-oriented local sums are used.
‘10’: wide column-oriented local sums are used.
‘11’: narrow column-oriented local sums are used.
The value R encoded mod 26 as a 6-bit unsigned binary
integer.
The value (Ω − 4) encoded as a 4-bit unsigned binary
integer.
The value (log2 tinc − 4) encoded as a 4-bit unsigned
binary integer.

4.4

4

The value (vmin + 6) encoded as a 4-bit unsigned binary
integer.

4.10.2

4

The value (vmax + 6) encoded as a 4-bit unsigned binary
integer.

4.10.2

1

‘0’: Weight Exponent Offset Table is not included in
Predictor Metadata.
‘1’: Weight Exponent Offset Table is included in Weight
Tables subpart of Predictor Metadata.
‘0’: default weight initialization is used.
‘1’: custom weight initialization is used.
‘0’: Weight Initialization Table is not included in Predictor
Metadata.
‘1’: Weight Initialization Table is included in Weight Tables
subpart of Predictor Metadata.
When the default weight initialization is used, this field
shall have value ‘00000’.
Otherwise, this field shall contain the value Q encoded as
a 5-bit unsigned binary integer.

4.10.3

4

1

Page 5-7

4.7.2
4.6.1
4.10.2

4.6.3
4.6.3

4.6.3

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.3.3

Weight Tables

5.3.3.3.1

General

5.3.3.3.1.1 The Weight Tables subpart of the Predictor Metadata header part shall be
present if the Weight Initialization Table Flag or Weight Exponent Offset Table Flag is set to
‘1’ and be omitted otherwise.
5.3.3.3.1.2
table 5-7.

When present, the Weight Tables subpart shall have the structure specified in

Table 5-7: Weight Tables Subpart Structure
Block
Weight Initialization Table
Weight Exponent Offset Table

5.3.3.3.2

Status
Optional
Optional

Size
Variable
Variable

Reference
5.3.3.3.2
5.3.3.3.3

Weight Initialization Table

5.3.3.3.2.1 The optional Weight Initialization Table may be included only when the custom
weight initialization method is selected. The presence of the Weight Initialization Table
shall be indicated by setting the Weight Initialization Table Flag field to ‘1’.
NOTE – Even when the custom weight initialization option is used, the Weight
Initialization Table may be omitted. For example, a mission might design a fixed
set of custom weight initialization vectors for an instrument to be used
throughout a mission and elect to not encode these vectors with each image.
5.3.3.3.2.2 When the Weight Initialization Table is included, the custom weight
N −1
initialization vectors {Λ z }z =Z0 shall be encoded, component-by-component, with each

component encoded as a Q-bit signed two’s complement binary integer, in the order defined
by the nesting of loops as follows:
for z = 0 to NZ −1
for j = 0 to Cz −1
encode component j of Λz .

5.3.3.3.2.3 Fill bits shall be appended to the Weight Initialization Table as needed to reach
the next byte boundary.

CCSDS 123.0-B-2

Page 5-8

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.3.3.3

Weight Exponent Offset Table

5.3.3.3.3.1 The optional Weight Exponent Offset Table may be included only when the
Weight Exponent Offset Flag field is ‘1’. The presence of the optional Weight Exponent
Offset Table shall be indicated by setting the Weight Exponent Offset Table Flag field to ‘1’.
NOTE – Even when nonzero values of ς z(i ) and ς z* are used, the Weight Exponent Offset
Table might be omitted. For example, a mission might design a fixed set of
custom weight exponent offsets for an instrument to be used throughout a
mission and elect to not encode these vectors with each image.
5.3.3.3.3.2 When the Weight Exponent Offset Table is included, the inter-band weight
exponent offsets ς z(i ) and inter-band weight exponent offsets ς z* , for z = 0,…, NZ −1 and
i = 1,..., Pz* , shall be encoded, component-by-component, with each component encoded as a
4-bit signed two’s complement binary integer, in the order defined by the nesting of loops as
follows:
for z = 0 to NZ −1
if full prediction mode is used
encode ς z*
for i = 1 to Pz*
encode ς z(i ) .
5.3.3.3.3.3 Fill bits shall be appended to the Weight Exponent Offset Table as needed to
reach the next byte boundary.
5.3.3.4

Quantization

5.3.3.4.1

General

5.3.3.4.1.1 The Quantization subpart shall be included unless the quantizer fidelity control
method is lossless (see 4.8.2.1), in which case it shall be omitted.
5.3.3.4.1.2
table 5-8.

When present, the Quantization subpart shall have the structure specified in
Table 5-8: Quantization Subpart Structure
Block
Error Limit Update Period
Absolute Error Limit
Relative Error Limit

CCSDS 123.0-B-2

Status
Conditional
Conditional
Conditional

Page 5-9

Size (Bytes)
1
Variable
Variable

Reference
5.3.3.4.2
5.3.3.4.3
5.3.3.4.4

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.3.4.2

Error Limit Update Period

5.3.3.4.2.1 When the Quantization subpart is present, it shall include the Error Limit
Update Period block unless BSQ encoding is used, in which case it shall be omitted.
5.3.3.4.2.2 When present, the Error Limit Update Period block shall have the structure
specified in table 5-9.
Table 5-9: Error Limit Update Period Block Structure
Field
Reserved
Periodic
Updating Flag
Reserved
Update Period
Exponent

5.3.3.4.3

Width
(bits)
1
1
2
4

Description

Reference

This field shall have value ‘0’.
‘0’: periodic error limit updating is not used.
‘1’: periodic error limit updating is used.
This field shall contain all ‘zeros’.
When periodic error limit updating is used, this field
shall contain the value u encoded as a 4-bit unsigned
binary integer. Otherwise, this field shall contain all
‘zeros’.

4.8.2.4

4.8.2.4

Absolute Error Limit

5.3.3.4.3.1

General

5.3.3.4.3.1.1 The Absolute Error Limit block shall be included when absolute error limits
are used and be omitted otherwise.
5.3.3.4.3.1.2 When present, the Absolute Error Limit block shall have the structure
specified in table 5-10.
Table 5-10: Absolute Error Limit Block Structure
Field
Reserved
Absolute Error Limit
Assignment Method
Reserved
Absolute Error Limit
Bit Depth
Absolute Error Limit
Values Subblock
(conditional)

CCSDS 123.0-B-2

Width
(bits)
1
1
2
4
(variable)

Description

Reference

This field shall have value ‘0’.
‘0’: band-independent absolute error limit assignment.
‘1’: band-dependent absolute error limit assignment.
This field shall have value ‘00’.
The value DA encoded mod 24 as a 4-bit unsigned
integer.
(See 5.3.3.4.3.2 below.)

Page 5-10

4.8.2.3.1

4.8.2.2.1
4.8.2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.3.4.3.2

Absolute Error Limit Values Subblock

5.3.3.4.3.2.1 When the Absolute Error Limit block is present, it shall include the Absolute
Error Limit Values Subblock unless periodic error limit updating is used, in which case it
shall be omitted.
5.3.3.4.3.2.2 If band-independent absolute error limits are used, then the Absolute Error
*
Limit Values Subblock consists of the value A encoded as a DA-bit unsigned binary integer,
followed by fill bits as needed to reach the next byte boundary.
5.3.3.4.3.2.3 If band-dependent absolute error limits are used, then the Absolute Error
Limit Values Subblock shall consist of (a) the sequence of az values, in order of increasing
band index z, each encoded as a DA-bit unsigned binary integer, followed by (b) fill bits as
needed to reach the next byte boundary.
5.3.3.4.4

Relative Error Limit

5.3.3.4.4.1

General

5.3.3.4.4.1.1 The Relative Error Limit block shall be included when relative error limits are
used and shall be omitted otherwise.
5.3.3.4.4.1.2 When present, the Relative Error Limit block shall have the structure
specified in table 5-11.
Table 5-11: Relative Error Limit Block Structure
Field
Reserved
Relative Error
Limit Assignment
Method
Reserved
Relative Error
Limit Bit Depth
Relative Error
Limit Values
Subblock
(conditional)

CCSDS 123.0-B-2

Width
(bits)
1
1
2
4
(variable)

Description
This field shall have value ‘0’.
‘0’: band-independent relative error limit assignment.
‘1’: band-dependent relative error limit assignment.

Reference
4.8.2.3.2

This field shall have value ‘00’.
The value DR encoded mod 24 as a 4-bit unsigned
integer.
(See 5.3.3.4.4.2 below.)

Page 5-11

4.8.2.2.2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.3.4.4.2

Relative Error Limit Values Subblock

5.3.3.4.4.2.1 When the Relative Error Limit block is present, it shall include the Relative
Error Limit Values Subblock unless periodic error limit updating is used, in which case it
shall be omitted.
5.3.3.4.4.2.2 If band-independent relative error limits are used, then the Relative Error
*
Limit Values Subblock shall consist of the value R encoded as a DR-bit unsigned binary
integer, followed by fill bits as needed to reach the next byte boundary.
5.3.3.4.4.2.3 If band-dependent relative error limits are used, then the Relative Error Limit
Values Subblock shall consist of (a) the sequence of rz values, in order of increasing band
index z, each encoded as a DR-bit unsigned binary integer, followed by (b) fill bits as needed
to reach the next byte boundary.
5.3.3.5

Sample Representative

5.3.3.5.1

General

5.3.3.5.1.1 The Sample Representative subpart may only be included when Θ > 0. The
inclusion of the Sample Representative subpart shall be indicated by setting the Sample
Representative Flag field bit to ‘1’.
5.3.3.5.1.2 When present, the Sample Representative subpart shall have the structure
specified in table 5-12.
Table 5-12: Sample Representative Subpart Structure
Field
Reserved
Sample
Representative
Resolution
Reserved
Band-Varying
Damping Flag

Width
(bits)
5
3
1
1

Reference

This field shall contain all ‘zeros’.
Value of Θ encoded as a 3-bit unsigned binary integer.

4.9.1

This field shall have value ‘0’.
‘0’: all bands use the same value of ϕz.

4.9.1

‘0’: the Damping Table subblock is not included in the
Sample Representative subpart.
‘1’: the Damping Table subblock is included in the
Sample Representative subpart.
This field shall have value ‘0’.

4.9.1

‘1’: the value ϕz of may vary from band to band.

Damping Table
Flag

1

Reserved

1

CCSDS 123.0-B-2

Description

Page 5-12

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION
Width
(bits)
4

Field
Fixed Damping
Value

4.9.1

‘0’: all bands use the same value of ѱz.

4.9.1
4.9.1

(variable)

‘0’: the Offset Table subblock is not included in the
Sample Representative subpart.
‘1’: the Offset Table subblock is included in the Sample
Representative subpart.
This field shall have value ‘0’.
If the Band-Varying Offset Field Flag field is ‘0’, then
this field encodes the value of ѱz to use for all bands as
a 4-bit unsigned integer.
Otherwise, this field shall be all ‘zeros’.
(See 5.3.3.5.2 below.)

(variable)

(See 5.3.3.5.3 below.)

4.9.1

1
1

Offset Table
Flag

1

Reserved
Fixed Offset
Value

1
4

5.3.3.5.2

Reference

If the Band-Varying Damping Flag field is ‘0’, then this
field encodes the value of ϕz to use for all bands as a 4bit unsigned integer.
Otherwise, this field shall be all ‘zeros’.
This field shall have value ‘0’.

Reserved
Band-Varying
Offset Flag

Damping Table
Subblock
(optional)
Offset Table
Subblock
(optional)

Description

‘1’: the value of ѱz may vary from band to band.

4.9.1

4.9.1

Damping Table Subblock

5.3.3.5.2.1 The optional Damping Table Subblock may only be included when the BandVarying Damping Flag field is ‘1’. The inclusion of the Damping Table Subblock shall be
indicated by setting the Damping Table Flag field to ‘1’.
NOTE – Even when the damping value ϕz varies from band to band, the Damping Table
Subblock might be omitted. For example, a mission might design a fixed set of
damping values to be used throughout a mission and elect to not encode these
values with each image.
5.3.3.5.2.2 When present, the Damping Table Subblock shall consist of (a) the sequence of
ϕz values, in order of increasing band index z, each encoded as a Θ-bit unsigned binary
integer, followed by (b) fill bits as needed to reach the next byte boundary.
5.3.3.5.3

Offset Table Subblock

5.3.3.5.3.1 The optional Offset Table Subblock may only be included when the BandVarying Offset Flag field is ‘1’. The inclusion of the Offset Table Subblock shall be
indicated by setting the Offset Table Flag field to ‘1’.

CCSDS 123.0-B-2

Page 5-13

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

NOTE – Even when the offset value ѱz varies from band to band, the Offset Table
Subblock might be omitted. For example, a mission might design a fixed set of
offset values to be used throughout a mission and elect to not encode these values
with each image.
5.3.3.5.3.2 When present, the Offset Table Subblock shall consist of (a) the sequence of ѱz
values, in order of increasing band index z, each encoded as a Θ-bit unsigned binary integer,
followed by (b) fill bits as needed to reach the next byte boundary.
5.3.4
5.3.4.1

ENTROPY CODER METADATA
General

The Entropy Coder Metadata header part shall follow the structure defined in 5.3.4.2 if the
sample-adaptive entropy coder is used, the structure defined in 5.3.4.3 if the hybrid entropy
coder is used, or the structure defined in 5.3.4.4 if the block-adaptive entropy coder is used.

CCSDS 123.0-B-2

Page 5-14

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.4.2

Sample-Adaptive Entropy Coder

5.3.4.2.1

Header

When the sample-adaptive entropy coder is used, the Entropy Coder Metadata header part
shall have the structure specified in table 5-13.
Table 5-13: Entropy Coder Metadata Structure When Sample Adaptive Entropy
Coder Is Used
Width
(bits)
5

Field
Unary Length
Limit

Description

Reference

The value Umax encoded mod 25 as a 5-bit unsigned
binary integer.

5.4.3.2.2

*

Rescaling
Counter Size

3

The value (γ −4) encoded as a 3-bit unsigned binary
integer.

5.4.3.2.3.4

Initial Count
Exponent

3

The value γ0 encoded mod 23 as a 3-bit unsigned binary
integer.

5.4.3.2.3.2

When an accumulator initialization constant K is specified,
this field encodes the value of K as a 4-bit unsigned binary
integer. Otherwise, this field shall be all ‘ones’.
1
‘0’: Accumulator Initialization Table is not included in
Entropy Coder Metadata.
‘1’: Accumulator Initialization Table is included in Entropy
Coder Metadata.
(variable) (See 5.3.4.2.2 below.)

5.4.3.2.3.3

Accumulator
Initialization
Constant
Accumulator
Initialization
Table Flag
Accumulator
Initialization
Table (Optional)

5.3.4.2.2

4

5.4.3.2.3.3

5.4.3.2.3.3

Accumulator Initialization Table

5.3.4.2.2.1 The optional Accumulator Initialization Table may be included when an
accumulator initialization constant is not specified. The presence of an accumulator
initialization table shall be indicated by setting the Accumulator Initialization Table Flag
field to ‘1’.
NOTE – Even when an accumulator initialization constant is not used, the Accumulator
Initialization Table may be omitted. For example, a mission might design a fixed
set of accumulator initialization values to be used throughout a mission and elect
to not encode these values with each image.
5.3.4.2.2.2 The Accumulator Initialization Table shall consist of the concatenated sequence
of k z′′ values, k0′′ , k1′′ ,  , k N −1′′ (defined in 5.4.3.2.3.3), each encoded as a 4-bit binary
unsigned integer.

CCSDS 123.0-B-2

Z

Page 5-15

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.3.4.2.2.3 Fill bits shall be appended to the Accumulator Initialization Table as needed to
reach the next byte boundary.
5.3.4.3

Hybrid Entropy Coder

When the hybrid entropy coder is used, the Entropy Coder Metadata header part shall have
the structure specified in table 5-14.
Table 5-14: Entropy Coder Metadata Structure When Hybrid Entropy Coder Is Used
Field
Unary Length
Limit

Width
(bits)
5

Description

Reference

The value Umax encoded mod 25 as a 5-bit unsigned
binary integer.

5.4.3.3.3.2.2

*

Rescaling
Counter Size

3

The value (γ −4) encoded as a 3-bit unsigned binary
integer.

5.4.3.3.4.4

Initial Count
Exponent

3

5.4.3.3.4.2

Reserved

5

The value γ0 encoded mod 23 as a 3-bit unsigned
binary integer.
This field shall have value ‘00000’.

5.3.4.4

Block-Adaptive Entropy Coder

When the block-adaptive entropy coder is used, the Entropy Coder Metadata header part
shall have the structure specified in table 5-15.
Table 5-15: Entropy Coder Metadata Structure When Block Adaptive Entropy
Coder Is Used
Field
Reserved
Block Size

Width
(bits)
1
2

Description

Reference

This field shall have value ‘0’.
‘00’: Block size J = 8.
‘01’: Block size J = 16.
‘10’: Block size J = 32.
‘11’: Block size J = 64.

5.4.3.4.2.4

Restricted Code
Options Flag

1

This field shall have value ‘1’ when D ≤ 4 and the Restricted
set of code options (as defined in subsection 5.1.2 of
reference [1]) are used. Otherwise, this field shall have value
‘0’.

Reference
Sample Interval

12

Value of r encoded mod 212 as a 12-bit unsigned binary
integer.

CCSDS 123.0-B-2

Page 5-16

5.4.3.4.2.5

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.4

BODY

5.4.1

OVERVIEW

The entropy coder input sequence consists of the mapped quantizer indices, and, when
periodic error limit updating is used (see 4.8.2.4), quantizer error limit values. This input
sequence is arranged in one of the allowed orders specified in 5.4.2. The compressed image
body losslessly encodes this sequence using one of the three entropy coding methods
specified in 5.4.3.
5.4.2

INPUT ORDER

5.4.2.1

General

The entropy coder input sequence shall be arranged in Band-Interleaved (BI) order, as
defined in 5.4.2.2, or BSQ order, as defined in 5.4.2.3.
NOTES
1

The input order specifies the order in which the entropy coder input sequence values
are input to the entropy coder.

2

The commonly used Band-Interleaved-by-Pixel (BIP) and Band-Interleaved-by-Line
(BIL) orders are each special cases of the more general BI encoding order.

3

The entropy coder input sequence order does not necessarily correspond to the order
in which samples are produced by an imaging instrument or processed by a predictor
implementation.

5.4.2.2

Band-Interleaved Order

5.4.2.2.1 The user-specified sub-frame interleaving depth M shall be an integer in the range
1 ≤ M ≤ NZ.
5.4.2.2.2 Under BI input order, the entropy coder input sequence order is defined by the
nesting of sample index loops as follows:
for y = 0 to NY −1
u
if y mod 2 = 0 and periodic error limit updating is used
if absolute error limits are used
if absolute error limits are band-independent
*
input A to the entropy coder
else
input a0 , a1 ,..., aN Z −1 to the entropy coder

CCSDS 123.0-B-2

Page 5-17

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

if relative error limits are used
if relative error limits are band-independent
*
input R to the entropy coder
else
input r0 , r1 ,..., rN Z −1 to the entropy coder
for i = 0 to  N Z / M  − 1
for x = 0 to NX −1
for z = iM to min {(i + 1) M −−
1, N Z 1}
input δz,y,x to the entropy coder.
NOTES
1

Under BI encoding order, when M = 1, the input order corresponds to BIL, and when
M = NZ the input order corresponds to BIP.

2

When periodic error limit updates are not used, error limit values are not part of the
entropy coder input sequence and instead are encoded in the header as specified in
5.3.3.4.

5.4.2.3

Band-Sequential Order

Under BSQ input order, the entropy coder input sequence order is defined by the nesting of
sample index loops as follows:
for z = 0 to NZ −1
for y = 0 to NY −1
for x = 0 to NX −1
input δz,y,x to the entropy coder.
NOTE – As specified in 4.8.2.4, periodic error limit updates are not permitted when BSQ
encoding order is used.
5.4.3
5.4.3.1

ENTROPY CODING METHOD
General

The entropy coder input sequence shall be encoded using either the sample-adaptive entropy
coding approach specified in 5.4.3.2, the hybrid entropy coding approach specified in 5.4.3.3,
or the block-adaptive entropy coding approach specified in 5.4.3.4.

CCSDS 123.0-B-2

Page 5-18

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.4.3.2
5.4.3.2.1

Sample-Adaptive Entropy Coder
General

Under the sample-adaptive entropy coding option, each mapped quantizer index δz(t) shall be
encoded using a variable-length binary codeword.
NOTE – The family of variable-length codes used is defined in 5.4.3.2.2, and the adaptive
code selection statistics used to select the codeword for each mapped quantizer
index are specified in 5.4.3.2.3. The procedure for selecting the codeword for
each mapped quantizer index and encoding error limit values is specified in
5.4.3.2.4.
5.4.3.2.2

Length-Limited Golomb-Power-of-2 Codewords

5.4.3.2.2.1 The length-limited Golomb-power-of-2 (GPO2) codeword for unsigned integer
j and unsigned integer code index k, denoted ℜk ( j ) , is a variable-length binary codeword
defined as follows:
a) if  j / 2k  < Umax then ℜk ( j ) consists of  j / 2k  ‘zeros’, followed by a ‘one’,
followed by the k least significant bits of the binary representation of j;
b) otherwise, ℜk ( j ) consists of Umax ‘zeros’ followed by the D-bit binary representation
of j.
5.4.3.2.2.2 The user-specified unary length limit Umax shall be an integer in the range
8 ≤ Umax ≤ 32.
NOTE – The definition ensures that each codeword ℜk ( j ) is not longer than Umax + D bits.
5.4.3.2.3

Adaptive Code Selection Statistics

5.4.3.2.3.1 The adaptive code selection statistics shall consist of an accumulator Σz(t) and a
counter Γ(t) that are adaptively updated during the encoding process.
NOTE – The ratio Σz(t) / Γ(t) provides an estimate of the mean mapped quantizer index
value in the spectral band. This ratio determines the variable-length code used to
encode δz(t).

CCSDS 123.0-B-2

Page 5-19

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.4.3.2.3.2

The initial counter value Γ(1) shall be equal to
(57)

Γ(1) =
2γ 0 ,
where the user-specified value of the initial count exponent γ0 shall be an integer in the range
1 ≤ γ0 ≤ 8.
5.4.3.2.3.3

For each spectral band z, the initial accumulator value Σz(1) shall be equal to

1

Σ z (1)=  7 3 ⋅ 2k z′ + 6 − 49 Γ(1)  ,
2


(58)

k ′′ ,
k z′′ ≤ 30 − D
,
k z′ =  z
2k z′′ + D − 30, k z′′ > 30 − D

(59)

(

)

where

and the user-selected value k z′′ shall be an integer in the range 0 ≤ k z′′′ ≤ min( D − 2,14) . An
accumulator initialization constant K may be specified, with 0 ≤ K ≤ min( D − 2,14) , in
which case k z′′ = K for all z.
NOTE – This calculation ensures that initial value of encoding parameter kz(t) computed
for spectral band z (see 5.4.3.2.4.3) will be equal to k z′ .
5.4.3.2.3.4

For t >1, the value of the accumulator for spectral band z is defined as
Σ z (t − 1) + δ z (t − 1),
Γ(t − 1) < 2γ − 1

Σ z (t ) =
,
  Σ z (t − 1) + δ z (t − 1) + 1 
γ∗
Γ
−
=
−
t
,
(
1)
2
1


2


∗

(60)

and the value of the counter is defined as
Γ(t − 1) + 1,
Γ(t − 1) < 2γ − 1

Γ(t ) =
.
  Γ(t − 1) + 1 
γ∗
t
Γ
−
=
−
,
(
1)
2
1


2

∗

(61)

The interval at which the counter Γ(t) and the accumulator Σz(t) are rescaled is controlled by
*
the user-defined rescaling counter size parameter γ , which shall be an integer in the range
*
max{4, γ0 + 1} ≤ γ ≤ 11.

CCSDS 123.0-B-2

Page 5-20

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.4.3.2.4

Coding Procedure

5.4.3.2.4.1 Each absolute error limit value shall be encoded as a DA-bit unsigned binary
integer, and each relative error limit value shall be encoded as a DR-bit unsigned binary
integer.
NOTE – The adaptive code selection statistics are unaffected by the encoding of error
limit values.
5.4.3.2.4.2 The first mapped quantizer index in each spectral band z shall be uncoded; that
is, the codeword for δz(0) is simply the D-bit unsigned binary integer representation of δz(0).
5.4.3.2.4.3

For t > 0, the codeword for the mapped quantizer index δz(t) is ℜk z (t ) (δ z (t )) ,

 49

where kz(t) = 0 if 2Γ(t ) > Σ z (t ) +  7 Γ(t )  ; otherwise, kz(t) is the largest positive integer
2

kz(t) ≤ D – 2, such that
 49

Γ(t )2k z (t ) ≤ Σ z (t ) +  7 Γ(t )  .
2


(62)

5.4.3.2.4.4 Following the last codeword in the compressed image, fill bits shall be
appended as needed to reach the next output word boundary, so that the compressed image
size is a multiple of the output word size. Fill bits shall be all ‘zeros’.
5.4.3.3
5.4.3.3.1

Hybrid Entropy Coder
Overview

Under the hybrid entropy coding option, adaptive code selection statistics are used to assign
each mapped quantizer index to either a ‘high-entropy’ or ‘low-entropy’ coding method.
Each high-entropy mapped quantizer index is encoded using a variable-length binary
codeword from a family of codes. For each low-entropy mapped quantizer index, one of 16
variable-to-variable length codes is used. A single output codeword from a low-entropy code
can encode multiple input-mapped quantizer indices, which allows lower compressed data
rates than can be achieved by the high-entropy codes. Each high-entropy mapped quantizer
index immediately produces an output codeword that is written to the compressed bitstream,
while each low-entropy code waits until enough data has arrived to determine the next output
codeword.
The decoder can accommodate the varying latency between the arrival of a low-entropy
mapped quantizer index and its ultimate encoding by decoding the compressed image body
in reverse order. This is possible because (1) the output codewords from the high- and lowentropy codes are suffix-free rather than prefix-free, (2) the compressed image body ends
with a compressed image ‘tail’ (see 5.4.3.3.5.4) that encodes the final state of each lowentropy code and the final high-resolution accumulator value for each band, and (3) each

CCSDS 123.0-B-2

Page 5-21

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

time the adaptive code selection statistics are rescaled (see 5.4.3.3.4.4), an additional bit is
output (see 5.4.3.3.5.1.2) so that the decoder can invert this rescaling operation. Because
decoding proceeds in reverse, users need to provide a mechanism by which the decoder can
locate the end of the compressed image body (see 2.4).
5.4.3.3.2

General

The high-entropy and low-entropy encoding methods used to encode mapped quantizer
indices are specified in 5.4.3.3.3. The coding method selection depends on the adaptive code
selection statistics specified in 5.4.3.3.4. Following the processing of the entropy coder input
sequence using the procedure specified in 5.4.3.3.5, the compressed image body concludes
with the compressed image tail, specified in 5.4.3.3.5.4.
5.4.3.3.3
5.4.3.3.3.1

Encoding Methods
Overview

A mapped quantizer index is encoded using one of several reversed length-limited GPO2
codes specified in 5.4.3.3.3.2, or using one of 16 low-entropy codes specified in 5.4.3.3.3.3.
5.4.3.3.3.2

Reversed Length-Limited Golomb-Power-of-2 Codewords

5.4.3.3.3.2.1 The reversed length-limited GPO2 codeword for unsigned integer j and
unsigned integer code index k, denoted ℜ′k ( j ) , is a variable-length binary codeword defined
as follows:
a) if  j / 2k  < Umax then ℜ′k ( j ) consists of the k least significant bits of the binary
representation of j, followed by a ‘one’, followed by  j / 2k  ‘zeros’;
b) otherwise, ℜ′k ( j ) consists of the D-bit binary representation of j followed by Umax
‘zeros’.
NOTE – The codewords ℜ′k ( j ) and ℜk ( j ) are equivalent, but with the bits arranged in a
different order. Also, ℜ′k ( j ) is not in general the reverse of ℜk ( j ) .
5.4.3.3.3.2.2 The user-specified unary length limit Umax shall be an integer in the range
8 ≤ Umax ≤ 32.

CCSDS 123.0-B-2

Page 5-22

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.4.3.3.3.3

Low-Entropy Codes

5.4.3.3.3.3.1 The low-entropy codes are a set of 16 non-binary-input, binary-output,
variable-to-variable length codes. Each low-entropy shall consist of
a) a threshold value Ti and input symbol limit Li , values for both of which shall be those
given in table 5-16;
b) a code defined by a prefix-free set of non-binary variable-length input codewords
with a mapping onto a set of variable-length binary output codewords; and
c) a flush table that gives a mapping from the set of all proper prefixes of input
codewords onto a set of output flush words.
NOTE – The code table and flush table for each low-entropy code are specified in annex B.
Table 5-16: Low-Entropy Code Input Symbol Limit and Threshold
Code Index, i

Input Symbol Limit, Li

Threshold, Ti

0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

12
10
8
6
6
4
4
4
2
2
2
2
2
2
2
0

303336
225404
166979
128672
95597
69670
50678
34898
23331
14935
9282
5510
3195
1928
1112
408

5.4.3.3.3.3.2 During encoding, each low-entropy code has an active prefix, which is a
sequence of input symbols. Initially, the active prefix for each low-entropy code shall be
equal to the null (empty) sequence.

CCSDS 123.0-B-2

Page 5-23

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.4.3.3.4

Adaptive Code Selection Statistics

5.4.3.3.4.1 The adaptive code selection statistics for the hybrid entropy coder shall consist
of a high-resolution accumulator Σ z (t ) and a counter Γ(t), which are adaptively updated
during the encoding process.
NOTE – The ratio Σ z (t ) / Γ(t ) provides a scaled estimate of the mean mapped quantizer
index value in the spectral band. This ratio determines how δz(t) is encoded.
5.4.3.3.4.2

The initial counter value Γ(0) shall be equal to
(63)

Γ(0) =,
2γ 0
where the user-specified value of the initial count exponent γ0 shall be an integer in the range
1 ≤ γ0 ≤ 8.
For each spectral band z, the initial high-resolution accumulator value Σ z (0)
shall be a user-specified integer in the range 0 ≤ Σ (0) < 2 D +γ 0 .
5.4.3.3.4.3

z

NOTES
1

The value of Σ z (0) is not directly encoded in the header or bitstream.

2

If an estimate δˆz (such an estimate might arise from a preceding compressed image)
of the mean mapped quantizer index for spectral band z is available, then a reasonable
rule-of-thumb is to initialize Σ z (0) to be approximately equal to 4Γ(0)δˆz .

5.4.3.3.4.4
defined as

For t ≥ 1, the value of the high-resolution accumulator for spectral band z is
Σ z (t − 1) + 4δ z (t ),
Γ(t − 1) < 2γ − 1

,
Σ z (t ) =
 Σ z (t − 1) + 4δ z (t ) + 1 
γ∗
,
Γ
(
t
−
1)
=
2
−
1


2


∗

(64)

and the value of the counter is defined as

CCSDS 123.0-B-2

Page 5-24

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Γ(t − 1) + 1,
Γ(t − 1) < 2γ − 1

Γ(t ) =
.
  Γ(t − 1) + 1 
∗
, Γ(t − 1) = 2γ − 1


2


∗

(65)

5.4.3.3.4.5 The interval at which the counter Γ(t) and the high-resolution accumulator Σ z (t )
*
are rescaled is controlled by the user-defined rescaling counter size parameter γ , which shall be
*
an integer in the range max{4, γ0 + 1} ≤ γ ≤ 11.
5.4.3.3.5
5.4.3.3.5.1

Coding Procedure
General

5.4.3.3.5.1.1 Each absolute error limit value shall be encoded as a DA-bit unsigned binary
integer, and each relative error limit value shall be encoded as a DR-bit unsigned binary
integer.
NOTE – The adaptive code selection statistics are unaffected by the encoding of error
limit values.
∗

5.4.3.3.5.1.2 When Γ(t − 1) = 2γ − 1 (i.e., when code selection statistics are rescaled, as
described in 5.4.3.2.3.4), the least-significant bit of Σ z (t − 1) shall be encoded in the bitstream
(i.e., a single ‘1’ bit when this quantity is odd and a ‘0’ bit when it is even) immediately before
any bits output as a result of the processing steps for δz(t) specified below.
NOTE – This bit allows the decoder to reconstruct the sequence of high-resolution
accumulator values.
5.4.3.3.5.1.3 The first mapped quantizer index in each spectral band z shall be uncoded;
that is, the D-bit unsigned binary integer representation of δz(0) is output to the compressed
bitstream.
5.4.3.3.5.1.4 For t > 0, if Σ z (t ) ⋅ 214 ≥ T0 ⋅ Γ(t ) , then δz(t) is said to be a ‘high-entropy’
mapped quantized index and shall be encoded using a reversed length-limited GPO2 code as
described below in 5.4.3.3.5.2. Otherwise, δz(t) is said to be a ‘low-entropy’ mapped
quantized index and shall be processed as described below in 5.4.3.3.5.3.
NOTE – When D=2, the condition for using the high-entropy coding method is never met;
all mapped quantizer indices are low-entropy.

CCSDS 123.0-B-2

Page 5-25

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.4.3.3.5.2

High-Entropy Processing

If δz(t) is a high-entropy mapped quantizer index, then it shall be encoded by appending
codeword ℜ′k z (t ) (δ z (t )) to the compressed bitstream, where kz(t) is the largest positive

integer kz(t) ≤ max{D – 2, 2}, such that

 49

Γ(t )2k z (t ) + 2 ≤ Σ z (t ) +  5 Γ(t ) 
2
.

(66)

NOTE – For high-entropy samples, it can be shown that kz(t) ≥ 2.
5.4.3.3.5.3

Low-Entropy Processing

5.4.3.3.5.3.1 If δz(t) is a low-entropy mapped quantizer index, then it shall be encoded
using the low-entropy code with largest code index i satisfying Σ z (t ) ⋅ 214 < Γ(t ) ⋅ Ti .
5.4.3.3.5.3.2

The input symbol to the low-entropy code is
δ (t ), δ z (t ) ≤ Li
,
i z (t ) =  z
 X, δ z (t ) > Li

(67)

where Li is the input symbol limit for the code, and ‘X’ denotes the ‘escape’ symbol.
5.4.3.3.5.3.3 If ɩz(t) = X, then the residual value δz(t) − Li − 1 shall be encoded by
appending codeword ℜ′0 (δ z (t ) −−
Li 1) to the compressed bitstream.
5.4.3.3.5.3.4 The active prefix for the ith low-entropy code is updated by appending the
input symbol ɩz(t) to that active prefix.
5.4.3.3.5.3.5 If after updating the active prefix it is equal to a complete input codeword, as
specified in the code table for that code, then
a) the corresponding output codeword listed in the table shall be appended to the
compressed bitstream; and
b) the active prefix for the low-entropy code shall be reset to the null sequence.
NOTE – The low-entropy code designs ensure that the active prefix is always equal to a
complete input codeword whenever the input symbol is the escape symbol.

CCSDS 123.0-B-2

Page 5-26

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.4.3.3.5.4

Compressed Image Tail

5.4.3.3.5.4.1 Following the processing of the entropy coder input sequence as specified in
5.4.3.3.5.1.1–5.4.3.3.5.1.4, the compressed image tail shall be produced by using the lowentropy code flush tables to encode the active prefix of each low-entropy code as described
in 5.4.3.3.5.4.2, encoding the final high-resolution accumulator value in each band as
described in 5.4.3.3.5.4.3, appending an additional ‘1’ bit as described in 5.4.3.3.5.4.4, and
appending fill bits (if needed) as described in 5.4.3.3.5.4.5.
5.4.3.3.5.4.2 For each low-entropy code, in order of increasing code index, the active prefix
for the low-entropy code shall be encoded by writing the corresponding flush codeword
(given in the code’s flush table in annex B) to the compressed bitstream.
NOTE – The flush code tables define an output codeword for each possible active prefix,
including the null sequence. Thus a flush codeword is output for each of the 16
low-entropy codes.
5.4.3.3.5.4.3 For each spectral band z, in order of increasing band index, the final highresolution accumulator value Σ z ( N X ⋅ N Y − 1) shall be encoded directly as an unsigned
*
integer using 2 + D + γ bits.
5.4.3.3.5.4.4 Following the encoding of final high-resolution accumulator values, a single
‘1’ bit shall be appended.
NOTE – This ‘1’ bit allows the decoder to identify fill bits encoded in 5.4.3.3.5.4.5.
5.4.3.3.5.4.5 Fill bits shall be appended as needed to reach the next output word boundary,
so that the compressed image size is a multiple of the output word size. Fill bits shall be all
‘zeros’.
5.4.3.4
5.4.3.4.1

Block-Adaptive Entropy Coder
General

When the block-adaptive entropy coding method is used, the entropy coder input sequence
shall be encoded using the adaptive entropy coder specified in reference [1].
5.4.3.4.2

Parameters and Options

5.4.3.4.2.1 When the block-adaptive entropy coding method is used, the following options
and parameters shall apply.
5.4.3.4.2.2 The preprocessor function defined in section 4 of reference [1] shall not be
used. The option to bypass the preprocessor shall be used.

CCSDS 123.0-B-2

Page 5-27

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

5.4.3.4.2.3 The resolution parameter, n, defined in subsection 3.1 of reference [1], shall be
equal to the image dynamic range D.
5.4.3.4.2.4 The block size parameter, J, defined in subsection 3.1 of reference [1], shall be
equal to 8, 16, 32, or 64.
5.4.3.4.2.5 The reference sample interval parameter, r, defined in subsection 4.3 of
reference [1], shall be a positive integer not larger than 4096.
NOTE – Because the preprocessor is bypassed, reference samples are not included in the
compressed image body. The reference sample interval serves only to define an
interval of input data sample blocks that will be further segmented in the ‘zeroblock’ encoding option defined in reference [1].
5.4.3.4.2.6 Either the Basic or Restricted set of code options, as defined in subsection 5.1.2
of reference [1], may be used.
5.4.3.4.2.7 The input to the adaptive entropy coder specified in reference [1] shall be the
entropy coder input sequence, as specified in 5.4.2, with ‘zeros’ appended as needed so that
the length is a multiple of J.
5.4.3.4.3

Body

5.4.3.4.3.1 The compressed image body shall consist of the concatenation of the Coded
Data Sets (CDSes), defined in subsection 5.1.4 of reference [1], produced by the encoder.
5.4.3.4.3.2 Fill bits shall be appended after the last CDS as needed to reach the next output
word boundary, so that the compressed image size is a multiple of the output word size. Fill
bits shall be all ‘zeros’. Fill bits shall not be inserted between CDSes.

CCSDS 123.0-B-2

Page 5-28

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

ANNEX A
IMPLEMENTATION CONFORMANCE
STATEMENT (ICS) PROFORMA
(NORMATIVE)
A1

INTRODUCTION

A1.1

OVERVIEW

This annex provides the Implementation Conformance Statement (ICS) Requirements List
(RL) for an implementation of Low-Complexity Lossless and Near-Lossless Multispectral
and Hyperspectral Image Compression, CCSDS 123.0-B-2, February 2019. The ICS for an
implementation is generated by completing the RL in accordance with the instructions
below. An implementation claiming conformance must satisfy the mandatory requirements
referenced in the RL.
A1.2

ABBREVIATIONS AND CONVENTIONS

The RL consists of information in tabular form. The status of features is indicated using the
abbreviations and conventions described below.
Item Column
The label in the item column identifies the item in the table.
The use of nested item labels indicates subordination of conditional items. For example, an
item with label Li.j is not applicable unless the parent item Li is supported.
Description Column
The description column contains a brief description of the item. It implicitly means “Is this
item supported by the implementation?”
Reference Column
The reference column indicates the relevant subsection of Low-Complexity Lossless and
Near-Lossless Multispectral and Hyperspectral Image Compression, CCSDS 123.0-B-2 (this
document).
Status Column
The status column uses the following notations:
M

mandatory.

CCSDS 123.0-B-2

Page A-1

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

O

optional.

N/A

not applicable.

O.i

qualified optional—for a group of related optional items labeled by the same
numeral i, it is mandatory to support at least one of the items.

C.j

conditional—the requirement on the capability (‘M’, ‘O’, or ‘N/A’) depends
on the support of another optional item. The numeral j identifies a unique
conditional status expression defined immediately following the table.

C:<status>
indicates that the status applies for the given subordinate item when
the parent item is supported, and is not applicable otherwise.
<condition>:<status> indicates that the status applies only when the given condition
is met, and is not applicable otherwise. For example, ‘(Q2 or Q3):M’ indicates
that support for the item is mandatory if item Q2 or item Q3 are supported and
not applicable otherwise.
Values Allowed Column
The values allowed column contains the list or range of values allowed. The following
notations are used:
range of values:
example:

<min value> .. <max value>
2 .. 16

list of values:
example:

<value1>, <value2>, ..., <valueN>
3, 6, 9, …, 21

N/A

not applicable

Item Support or Values Supported Column
In the item support column, the support of every item as claimed by the implementer shall be
stated by entering the appropriate answer:
Y

yes, item supported by the implementation;

N

no, item not supported by the implementation;

N/A

not applicable.

In the values supported column, the implementer shall enter the values supported.
Prerequisite Line
A prerequisite line takes the form: Prerequisite: <predicate>. A prerequisite line at the top of
a table indicates that the table need not be completed if the predicate is FALSE.

CCSDS 123.0-B-2

Page A-2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

A1.3

INSTRUCTIONS FOR COMPLETING THE RL

An implementer shows the extent of compliance to the Recommended Standard by
completing the RL; that is, the state of compliance with all mandatory requirements and the
options supported are shown. The resulting completed RL is called an ICS. The implementer
shall complete the RL by entering appropriate responses in the support or values supported
column, using the notation described in A1.2. If a conditional requirement is inapplicable,
N/A should be used. If a mandatory requirement is not satisfied, exception information must
be supplied by entering a reference Xi, where i is a unique identifier, to an accompanying
rationale for the noncompliance.
A2

ICS PROFORMA FOR LOW-COMPLEXITY LOSSLESS AND NEARLOSSLESS MULTISPECTRAL AND HYPERSPECTRAL IMAGE
COMPRESSION

A2.1
A2.1.1

GENERAL INFORMATION
Identification of ICS

Date of Statement (DD/MM/YYYY)
ICS serial number
System Conformance statement
cross-reference

A2.1.2

Identification of Implementation Under Test

Implementation Name
Implementation Version
Function Implemented

Compression_____ Decompression_____

Special Configuration
Other Information

CCSDS 123.0-B-2

Page A-3

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

A2.1.3

Identification of Supplier

Supplier
Contact Point for Queries
Implementation Name(s) and Versions
Other information necessary for full
identification, for example, name(s) and
version(s) for machines and/or operating
systems;
System Name(s)

A2.1.4

Identification of Specification

CCSDS 123.0-B-2
Have any exceptions been required?
NOTE

–

Yes [ ]

No [ ]

A YES answer means that the implementation does not
conform to the Recommended Standard. Non-supported
mandatory capabilities are to be identified in the ICS, with
an explanation of why the implementation is nonconforming.

CCSDS 123.0-B-2

Page A-4

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

A2.2

REQUIREMENTS LIST

A1.1.1

Image
Table A-1: Image Properties

Item
I1
I2
I3
I4
I5
I6
I7

Description
Signed Samples
Unsigned Samples
X Size, NX
Y Size, NY
Z Size, NZ

Dynamic Range, D
Supplementary Information
Tables

Status
O.1
O.1
M

Values
Allowed
N/A
N/A
1 .. 216

3.2.2

M

1 .. 216

3.2.2

M

1 .. 216

3.3.1

M

2 .. 32

3.5

O

N/A

Reference
3.2.1
3.2.1
3.2.2

Item Support or
Values Supported

Table A-2: Supplementary Information Table Features

Cor. 1

Prerequisite: I7 – Supplementary Information Tables supported
Item
S1

Status

Values
Allowed

3.5.2.1

M

0 .. 15

Reference

S2

Table Purpose

3.5.2.2

M

S3

Unsigned Integer Tables
Unsigned Integer Table Bit
Depth, DI

3.5.2.3

O.2

0 .. 4,
10 .. 15
N/A

3.5.2.3.1

C:M

1 .. 32

3.5.2.4

C:M

Signed Integer Tables
Signed Integer Table Bit Depth,

3.5.2.3

O.2

0D, 1D,
2DZX,
2DYX
N/A

DI

3.5.2.3.2

C:M

1 .. 32

S4.2

Signed Integer Table Structure

3.5.2.4

C:M

S5

Float Tables
Float Table Significand Bit
Depth, DF
Float Table Exponent Bit Depth,

3.5.2.3

O.2

0D, 1D,
2DZX,
2DYX
N/A

3.5.2.3.3

C:M

1 .. 23

DE

3.5.2.3.3

C:M

2 .. 8

S5.3

Exponent Bias, β

3.5.2.3.3

C:M

S5.4

Float Table Structure

3.5.2.4

C:M

S3.1
S3.2
S4
S4.1

Cor. 1

Description
Number of Supplementary
Information Tables, τ

S5.1
S5.2

Unsigned Integer Table
Structure

CCSDS 123.0-B-2 Cor. 1

Page A-5

Item Support or
Values Supported

0 ..

2 DE − 1

0D, 1D,
2DZX,
2DYX

February
July2019
2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

A1.1.2

Predictor
Table A-3: Prediction Calculation Features

Item

Description

Reference Status

Values
Allowed

P1

Number of Prediction Bands, P

4.2

M

0 .. 15

P2
P3
P4

Full Prediction Mode
Reduced Prediction Mode
Wide Neighbor-Oriented Local Sums
Narrow Neighbor-Oriented Local
Sums
Wide Column-Oriented Local Sums
Narrow Column-Oriented Local
Sums

4.3
4.3
4.4

C.1
C.1
C.2

N/A
N/A
N/A

4.4

C.2

N/A

4.4

C.2

N/A

4.4

C.2

N/A

Register Size, R

4.7.2

M

max {32,
D + Ω + 2}

P5
P6
P7
P8
P9

.. 64

Sample Representative Resolution, Θ 4.9.1

0 .. 4

O

N/A

P11 Sample Representative Damping, ϕz 4.9.1

M

0 .. 2 −1

P12 Band-Varying Offset

5.3.3.4

O

N/A

P13 Sample Representative Offset, ѱz

4.9.1

M

0 .. 2 −1

5.3.3.4

Cor. 1

M

P10 Band-Varying Damping

Item Support or
Values Supported

Θ

Θ

C.1: When NX = 1, support is mandatory for Reduced Prediction Mode and not applicable
for Full Prediction Mode. Otherwise, it is mandatory to support at least one of these items.
C.2: When NX = 1, support is mandatory for Column-Oriented Local Sums and not
applicable for Neighbor-Oriented Local Sums. Otherwise, it is mandatory to support at least
one of these items.

CCSDS 123.0-B-2 Cor. 1

Page A-6

February
July2019
2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table A-4: Weight Initialization and Update Features
Item
W1
W2
W3
W3.1
W4
W5
W6
W7
W8

Description
Weight Component Resolution,

Ω

Default Weight Initialization
Custom Weight Initialization
Weight Initialization Resolution,
Q
Weight Update Scaling
Exponent Initial Parameter, vmin
Weight Update Scaling
Exponent Final Parameter, vmax
Weight Update Scaling
Exponent Change Interval, tinc
Intra-Band Weight Exponent
Offsets, ς z

(i )

Inter-Band Weight Exponent
Offset, ς z

*

CCSDS 123.0-B-2

Status

Values
Allowed

4.6.1

M

4 .. 19

4.6.3.2
4.6.3.3

O.3
O.3

N/A
N/A

4.6.3.3

C:M

3 .. Ω+3

4.10.2

M

4.10.2

M

vmin .. 9

4.10.2

M

24, 25,
…, 211

4.10.3

M

–6 .. 5

4.10.3

M

–6 .. 5

Reference

Page A-7

Item Support or
Values Supported

−6 ..

vmax

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table A-5: Quantization Features
Item
Q1
Q2

Q2.2
Q2.2.1
Q2.3
Q2.3.1
Q3

az

Band-Independent
Absolute Error Limits
Absolute Error Limit
*

Constant, A

Relative Error Fidelity
Control Method
Relative Error Limit Bit
Depth, DR

Status

Values Allowed

4.8.2

O.4

N/A

4.8.2

O.4

N/A

4.8.2.2.1

C:M

1 .. min{D −1,16}

4.8.2.3.1

C:O.5

N/A

4.8.2

C:M

0 .. 2 A − 1

4.8.2.3.1

C:O.5

N/A

4.8.2.3.1

C:M

0 .. 2 A − 1

4.8.2

O.4

N/A

4.8.2.2.2

C:M

1 .. min{D −1,16}

4.8.2.3.2

C:O.6

N/A

C:M

0 .. 2 R − 1

4.8.2.3.2

C:O.6

N/A

4.8.2.3.2

C:M

0 .. 2 R − 1

4.8.2.4

(Q2 or
Q3):O

N/A

4.8.2.4

C:M

0 .. 9

Q3.2

Band-Dependent
Relative Error Limits

Q3.2.1

Relative Error Limits, rz 4.8.2

Q3.3
Q3.3.1
Q4

*

Constant, R

Periodic Error Limit
Updating
Error Limit Update
Period Exponent, u

CCSDS 123.0-B-2 Cor. 1

Page A-8

D

D

D

D

Cor. 1

Q4.1

Band-Independent
Relative Error Limits
Relative Error Limit

Item Support or
Values Supported

Cor. 1

Q3.1

Band-Dependent
Absolute Error Limits
Absolute Error Limits,

Reference

Cor. 1

Q2.1

Description
Lossless Fidelity
Control Method
Absolute Error Fidelity
Control Method
Absolute Error Limit Bit
Depth, DA

February
July2019
2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

A1.1.3

Encoder
Table A-6: Encoder Features

Item
E1
E2
E2.1
E3
E4
E5
E6

Description
Output Word Size, B
BI Encoding Order
Sub-Frame Interleaving Depth, M
BSQ Encoding Order
Sample-Adaptive Entropy Coder
Hybrid Entropy Coder
Block-Adaptive Entropy Coder

Reference
5.2.2
5.4.2.2
5.4.2.2
5.4.2.3
5.4.3.2
5.4.3.3
5.4.3.4

Status
M
O.7
C:M
O.7
O.8
O.8
O.8

Values
Allowed
1 .. 8
N/A
1 .. NZ
N/A
N/A
N/A
N/A

Item Support or
Values Supported

Table A-7: Header Elements
Item
H1

Cor. 1

H2
H3
H4
H4.1
H4.2
H5
H5.1
H5.2
H5.3
H6
H7
H7.1
H8
H9

Description

Reference
Status
Image Metadata Part
Essential Subpart
5.3.2.2
M
Supplementary Information Tables
5.3.2.3
I7:M
Subpart
Predictor Metadata Part
Primary Subpart
5.3.3.2
M
Weight Tables Subpart
5.3.3.3
O
Weight Initialization Table Block
5.3.3.3.2
W3:O
Weight Exponent Offset Table Block
5.3.3.3.3
C:O
Quantization Subpart
5.3.3.4
(Q2 or Q3):M
Error Limit Update Period Block
5.3.3.4.2
E2:M
Absolute Error Limit Block
5.3.3.4.3
Q2:M
Relative Error Limit Block
5.3.3.4.4
Q3:M
Sample Representative Subpart
5.3.3.5
C.3
Entropy Coder Metadata Part
Sample-Adaptive Entropy Coder
5.3.4.2
E4:M
Metadata Part
Accumulator Initialization Table Block 5.3.4.2.2
C:O
Hybrid Entropy Coder Metadata Part
5.3.4.3
E5:M
Block-Adaptive Entropy Coder
5.3.4.4
E6:M
Metadata Part

Item Support

C.3: If the implementation supports nonzero values for any of the sample representative
parameters (items P9, P11, P13), then support for this item is mandatory; otherwise, it is not
applicable.

CCSDS 123.0-B-2 Cor. 1

Page A-9

February
July2019
2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table A-8: Sample-Adaptive Entropy Coder Features
Prerequisite: E4 – Sample-Adaptive Entropy Coder supported

ES3

Accumulator Initialization
Constant, K

ES4 Rescaling Counter Size, γ

*

ES5 Unary Length Limit, Umax

Reference
5.4.3.2.3.2

Status
M

5.4.3.2.3.3

O.9

5.4.3.2.3.3

O.9

5.4.3.2.3.4

M

5.4.3.2.2

M

Values
Allowed
1 .. 8

Item Support or
Values Supported

0 ..

min{D −2,14}

Cor. 2

Item
Description
ES1 Initial Count Exponent, γ0
Accumulator Initialization
ES2
Table, k z′′

0 ..

min{D −2,14}
max{4, γ0 + 1}
.. 11
8 .. 32

Table A-9: Hybrid Entropy Coder Features
Prerequisite: E5 – Hybrid Entropy Coder supported

EH3 Rescaling Counter Size, γ

*

EH4 Unary Length Limit, Umax

Values
Allowed
1 .. 8

Reference
5.4.3.3.4.2

Status
M

5.4.3.3.4.3

M

0 .. 2

5.4.3.3.4.4

M

max{4, γ0 + 1}

5.4.3.3.3.2.2

M

D +γ 0

Item Support or
Values Supported

Cor. 1

Item
Description
EH1 Initial Count Exponent, γ0
Initial High-Resolution
EH2
 (0)
Accumulator Value, Σ
z

−1

.. 11
8 .. 32

Table A-10: Block-Adaptive Entropy Coder Features
Prerequisite: E6 – Block-Adaptive Entropy Coder supported
Item
EB1
EB2
EB3
EB4

Description
Block Size, J
Reference Sample Interval, r
Basic Code Options
Restricted Code Options

CCSDS 123.0-B-2 Cor. 2

Reference
5.4.3.4.2.4
5.4.3.4.2.5
5.4.3.4.2.6
5.4.3.4.2.6

Status
M
M
O.10
O.10

Page A-10

Values
Allowed
8, 16, 32, 64
1 .. 4096
N/A
N/A

Item Support or
Values Supported

February
August
July2019
2019
2020

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

ANNEX B
LOW-ENTROPY CODE TABLES
(NORMATIVE)
Tables B-1–B-32 list the code tables and flush tables that define the encoding of low-entropy
samples, as described in 5.4.3.3.3.3. The following conventions are used in the tables:
–

In flush tables, (null) indicates an empty active prefix.

–

The notation 0^{i} is used to denote i consecutive occurrences of input symbol 0. By
convention, 0^{0} is interpreted as the empty sequence.

–

The notation n'hX denotes an output codeword having length n bits, where X is the
hexadecimal representation of that codeword. Thus, for example, 7'h1F denotes the
codeword 0011111.

–

The notation n'h(X+2r) or n'h(X+r) denotes an output codeword having length n bits,
where the quantity in parentheses evaluates to the hexadecimal representation of that
codeword. It should be noted that the quantity X is written in hexadecimal. Angle
brackets <> indicates the reversal of a binary codeword. Thus, for example, <7'h1F>
denotes the codeword 1111100.

For example, an entry in table B-27 for low entropy code 13 indicates that input codeword
0^{r}1, 1≤r≤2 produces output codeword <7'h(3F+2r)>. Thus, for this code, input codeword
001 is encoded via output codeword <7'h(3F+4)> = <7'h43> = <1000011> = 1100001.

CCSDS 123.0-B-2

Page B-1

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-1: Code Table for Low-Entropy Code 0
Input
Codeword
00
010
011
012
013
014
015
016
017
018
019
01A
01B
01C
01X
020
021
022
023
024
025
026
027
028
029
02A
02B
02C
02X
03
04
05
06
07
08

Output
Codeword
5'h19
8'h57
8'hD7
8'h37
9'h0AF
9'h1AF
9'h06F
9'h16F
10'h03F
10'h23F
11'h17F
11'h57F
12'h1FF
12'h9FF
11'h37F
8'hB7
8'h77
8'hF7
9'h0EF
9'h1EF
9'h01F
9'h11F
10'h13F
10'h33F
11'h77F
11'h0FF
12'h5FF
12'hDFF
11'h4FF
6'h15
6'h35
6'h0D
6'h2D
7'h13
7'h53

Input
Codeword
09
0A
0B
0C
0X
1
2
3
40
41
42
43
440
441
442
443
444
445
446
447
448
449
44A
44B
44C
44X
45
46
47
48
49
4A
4B
4C
4X

Output
Codeword
8’h3B
8’hBB
9’h00F
9’h10F
8’h7B
3’h0
3’h4
3’h2
6’h1D
6’h3D
6’h03
6’h23
9’h09F
9’h19F
9’h05F
10’h0BF
10’h2BF
10’h1BF
10’h3BF
11’h2FF
11’h6FF
12’h3FF
12’hBFF
13’h0FFF
13’h1FFF
12’h7FF
7’h33
7’h73
8’hFB
8’h07
9’h08F
9’h18F
9’h04F
9’h14F
8’h87

Input
Codeword
5
6
70
71
72
73
74
75
76
77
78
79
7A
7B
7C
7X
80
81
82
83
84
85
86
87
88
89
8A
8B
8C
8X
9
A
B
C
X

Output
Codeword
4'h6
4'hE
7'h0B
7'h4B
7'h2B
8'h47
8'hC7
8'h27
8'hA7
9'h0CF
9'h1CF
10'h15F
10'h35F
11'h07F
11'h47F
10'h0DF
7'h6B
7'h1B
7'h5B
8'h67
8'hE7
8'h17
8'h97
9'h02F
9'h12F
10'h2DF
10'h1DF
11'h27F
11'h67F
10'h3DF
5'h01
5'h11
6'h05
6'h25
5'h09

Table B-2: Flush Table for Low-Entropy Code 0
Active Prefix
(null)
0
01

Flush Word
1'h0
2'h1
5'h0F

CCSDS 123.0-B-2

Active Prefix
02
4
44

Flush Word
6’h1F
3’h3
6’h3F

Page B-2

Active Prefix
7
8

Flush Word
5'h07
5'h17

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-3: Code Table for Low-Entropy Code 1
Input
Codeword
000
001
002
003
004
005
006
007
008
009
00A
00X
01
02
030
031
032
033
034
035
036
037
038
039
03A
03X
040
041
042
043
044
045
046
047
048
049
04A
04X
05
06
07
08
09
0A
0X
10
11
12

CCSDS 123.0-B-2

Output
Codeword
7'h73
7'h0B
7'h4B
8'h9B
8'h5B
9'h137
9'h0B7
10'h11F
10'h31F
11'h63F
11'h13F
11'h53F
5'h0E
5'h1E
8'hDB
8'h3B
8'hBB
9'h1B7
9'h077
9'h177
9'h0F7
10'h09F
11'h33F
12'h57F
12'hD7F
11'h73F
8'h7B
8'hFB
8'h07
9'h1F7
9'h00F
9'h10F
10'h29F
11'h0BF
11'h4BF
12'h37F
12'hB7F
11'h2BF
6'h1D
6'h3D
7'h13
7'h53
9'h0E7
9'h1E7
8'h2B
5'h01
5'h11
5'h09

Input
Codeword
130
131
132
133
134
135
136
137
138
139
13A
13X
14
150
151
152
153
154
155
156
157
158
159
15A
15X
160
161
162
163
164
165
166
167
168
169
16A
16X
17
18
19
1A
1X
20
21
22
230
231
232

Output
Codeword
8’h87
8’h47
8’hC7
9’h08F
9’h18F
10’h19F
10’h39F
11’h6BF
11’h1BF
12’h77F
12’hF7F
12’h0FF
6’h03
9’h04F
9’h14F
9’h0CF
10’h05F
10’h25F
10’h15F
11’h5BF
12’h8FF
12’h4FF
13’h03FF
13’h13FF
12’hCFF
9’h1CF
9’h02F
9’h12F
10’h35F
10’h0DF
11’h3BF
11’h7BF
12’h2FF
12’hAFF
13’h0BFF
13’h1BFF
13’h07FF
8’hAB
8’h6B
9’h017
9’h117
9’h097
5’h19
5’h05
5’h15
8’h27
8’hA7
8’h67

Page B-3

Input
Codeword
233
234
235
236
237
238
239
23A
23X
24
250
251
252
253
254
255
256
257
258
259
25A
25X
26
27
28
29
2A
2X
3
4
5
6
7
8
9
A0
A1
A2
A3
A4
A5
A6
A7
A8
A9
AA
AX
X

Output
Codeword
9'h0AF
9'h1AF
10'h2DF
10'h1DF
11'h07F
11'h47F
12'h6FF
12'hEFF
12'h1FF
6'h23
9'h06F
9'h16F
9'h0EF
10'h3DF
10'h03F
11'h27F
11'h67F
12'h9FF
12'h5FF
13'h17FF
13'h0FFF
13'h1FFF
7'h33
8'hEB
8'h1B
9'h197
9'h057
9'h157
3'h0
3'h4
4'h2
4'hA
5'h06
5'h16
6'h0D
9'h0D7
9'h1D7
9'h037
10'h1EF
10'h3EF
10'h01F
10'h21F
11'h23F
12'h17F
13'h0DFF
13'h1DFF
12'h97F
6'h2D

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-4: Flush Table for Low-Entropy Code 1
Active Prefix
(null)
0
00
03
04

Flush Word
1'h0
3'h1
5'h07
6'h17
6'h37

Active Prefix
1
13
15
16
2

Flush Word
3’h5
6’h0F
7’h5F
7’h3F
3’h3

Active Prefix Flush Word
23
6'h2F
25
7'h7F
A
7'h1F

Table B-5: Code Table for Low-Entropy Code 2
Input
Codeword

0
10
110
111
112
113
114
115
116
117
118
11X
120
121
122
123
124
125
126
127
128
12X
130
131
132
133
134
135
136
137
138
13X
140
141
142
143
144
145
146
147

CCSDS 123.0-B-2

Output
Codeword
2'h0
4'h1
7'h7D
7'h03
7'h43
8'h3B
8'hBB
9'h0CF
9'h1CF
11'h3BF
11'h7BF
11'h07F
7'h23
7'h63
7'h13
8'h7B
8'hFB
9'h02F
9'h12F
11'h47F
11'h27F
11'h67F
7'h53
8'h07
8'h87
9'h0AF
9'h1AF
10'h0DF
10'h2DF
12'h2FF
12'hAFF
12'h6FF
8'h47
8'hC7
8'h27
9'h06F
9'h16F
10'h1DF
10'h3DF
12'hEFF

Input
Codeword
148
14X
15
16
17
18
1X
200
201
202
203
204
205
206
207
208
20X
210
211
212
213
214
215
216
217
218
21X
22
230
231
232
233
234
235
236
237
238
23X
240
241

Output
Codeword
12’h1FF
12’h9FF
7’h35
7’h75
8’h6B
9’h0F7
9’h1F7
6’h15
7’h33
7’h73
8’hA7
8’h67
9’h0EF
9’h1EF
11’h17F
11’h57F
11’h37F
7’h0B
7’h4B
7’h2B
8’hE7
8’h17
9’h01F
9’h11F
11’h77F
11’h0FF
11’h4FF
5’h09
8’h97
8’h57
8’hD7
9’h09F
9’h19F
10’h03F
10’h23F
12’h5FF
12’hDFF
12’h3FF
8’h37
8’hB7

Page B-4

Input
Codeword
242
243
244
245
246
247
248
24X
25
26
27
28
2X
3
4
50
51
52
53
54
55
56
57
58
5X
60
61
62
63
64
65
66
67
68
6X
7
8
X

Output
Codeword
8'h77
9'h05F
9'h15F
10'h13F
10'h33F
12'hBFF
12'h7FF
12'hFFF
7'h0D
7'h4D
8'hEB
9'h00F
9'h10F
3'h2
3'h6
6'h25
7'h2D
7'h6D
8'h1B
8'h9B
9'h08F
9'h18F
11'h0BF
11'h4BF
11'h2BF
7'h1D
7'h5D
7'h3D
8'h5B
8'hDB
9'h04F
9'h14F
11'h6BF
11'h1BF
11'h5BF
6'h19
6'h39
6'h05

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-6: Flush Table for Low-Entropy Code 2
Active Prefix
(null)
1
11
12
13

Flush Word
1'h0
3'h1
5'h0B
5'h1B
6'h0F

Active Prefix
14
2
20
21
23

Flush Word
6’h2F
3’h5
5’h07
5’h17
6’h1F

Active Prefix
Flush Word
24
6'h3F
5
5'h03
6
5'h13

Table B-7: Code Table for Low-Entropy Code 3
Input
Codeword
000
0010
0011
0012
0013
0014
0015
0016
001X
0020
0021
0022
0023
0024
0025
0026
002X
003
004
005
006
00X
01
02
03
04
05
06
0X
1
20
210
2110
2111
2112
2113
2114
2115
2116
211X

CCSDS 123.0-B-2

Output
Codeword
5'h19
7'h4B
8'h17
8'h97
9'h0EF
9'h1EF
11'h37F
11'h77F
12'h9FF
7'h2B
8'h57
8'hD7
9'h01F
9'h11F
11'h0FF
11'h4FF
12'h5FF
7'h43
7'h23
9'h18F
9'h04F
9'h14F
4'h2
4'hA
5'h1E
5'h01
7'h2D
7'h6D
8'h6B
2'h0
4'h6
6'h35
8'h37
9'h09F
9'h19F
10'h23F
10'h13F
12'hDFF
12'h3FF
13'h0FFF

Input
Codeword
212
213
214
215
216
21X
220
2210
2211
2212
2213
2214
2215
2216
221X
222
223
224
225
226
22X
230
231
232
233
234
235
236
23X
24
25
26
2X
30
310
311
312
313
314
315

Output
Codeword
7’h63
8’h3B
8’hBB
10’h2DF
10’h1DF
11’h1BF
6’h0D
8’hB7
9’h05F
9’h15F
10’h33F
10’h0BF
12’hBFF
12’h7FF
13’h1FFF
7’h13
8’h7B
8’hFB
10’h3DF
10’h03F
11’h5BF
7’h53
8’h07
8’h87
9’h0CF
9’h1CF
11’h3BF
11’h7BF
12’hAFF
6’h25
8’hEB
8’h1B
8’h9B
5’h11
7’h33
8’h47
8’hC7
9’h02F
9’h12F
11’h07F

Page B-5

Input
Codeword
316
31X
320
321
322
323
324
325
326
32X
33
34
35
36
3X
40
410
411
412
413
414
415
416
41X
42
43
44
45
46
4X
5
60
61
62
63
64
65
66
6X
X

Output
Codeword
11'h47F
12'h6FF
7'h73
8'h27
8'hA7
9'h0AF
9'h1AF
11'h27F
11'h67F
12'hEFF
7'h1D
7'h5D
9'h077
9'h177
9'h0F7
5'h09
7'h0B
8'h67
8'hE7
9'h06F
9'h16F
11'h17F
11'h57F
12'h1FF
6'h15
7'h3D
7'h7D
9'h1F7
9'h00F
10'h0DF
5'h0E
7'h03
8'h5B
8'hDB
9'h10F
9'h08F
11'h2BF
11'h6BF
12'h2FF
6'h05

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-8: Flush Table for Low-Entropy Code 3
Active Prefix
(null)
0
00
001
002
2

Flush Word
1'h0
3'h1
4'hB
7'h5F
7'h3F
3'h5

Active Prefix
21
211
22
221
23
3

Flush Word
6'h17
8'h7F
6'h37
8'hFF
7'h4F
4'h3

Active Prefix
31
32
4
41
6

Flush Word
7'h2F
7'h6F
5'h07
7'h1F
7'h0F

Table B-9: Code Table for Low-Entropy Code 4
Input
Codeword
000
0010
0011
0012
0013
0014
0015
0016
001X
002
003
004
005
006
00X
0100
0101
0102
0103
0104
0105
0106
010X
0110
0111
0112
0113
0114
0115
0116
011X

Output
Codeword
4'h5
6'h03
7'h2B
7'h6B
9'h11F
9'h09F
12'h8FF
12'h4FF
12'hCFF
5'h0D
7'h33
7'h73
9'h1EF
10'h15F
10'h35F
6'h23
7'h1B
7'h5B
9'h19F
9'h05F
12'h2FF
12'hAFF
12'h6FF
7'h3B
8'hF7
8'h0F
10'h13F
10'h33F
12'hEFF
13'h1DFF
13'h03FF

CCSDS 123.0-B-2

Input
Codeword
0120
0121
0122
0123
0124
0125
0126
012X
013
014
015
016
01X
020
0210
0211
0212
0213
0214
0215
0216
021X
0220
0221
0222
0223
0224
0225
0226
022X
023

Output
Codeword
7'h7B
8'h8F
8'h4F
10'h0BF
10'h2BF
12'h1FF
13'h13FF
13'h0BFF
8'hE7
8'h17
10'h0DF
10'h2DF
11'h17F
5'h1D
7'h07
8'hCF
8'h2F
10'h1BF
10'h3BF
12'h9FF
13'h1BFF
13'h07FF
7'h47
8'hAF
8'h6F
10'h07F
10'h27F
13'h17FF
13'h0FFF
13'h1FFF
8'h97

Page B-6

Input
Codeword
024
025
026
02X
030
031
032
033
034
035
036
03X
040
041
042
043
044
045
046
04X
05
06
0X
1
2
3
4
5
6
X

Output
Codeword
8'h57
10'h1DF
11'h57F
11'h37F
7'h0B
8'hD7
8'h37
9'h01F
10'h3DF
12'h77F
12'hF7F
13'h05FF
7'h4B
8'hB7
8'h77
10'h03F
10'h23F
12'h0FF
13'h15FF
13'h0DFF
8'hA7
8'h67
9'h0EF
2'h0
2'h2
4'h1
4'h9
7'h13
7'h53
8'h27

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-10: Flush Table for Low-Entropy Code 4
Active Prefix
(null)
0
00
001
01

Flush Word
1'h0
2'h1
4'h3
6'h37
4'hB

Active Prefix
010
011
012
02
021

Flush Word
6'h0F
6'h2F
7'h5F
5'h07
7'h3F

Active Prefix
022
03
04

Flush Word
7'h7F
6'h17
7'h1F

Table B-11: Code Table for Low-Entropy Code 5
Input
Codeword

0
1
2000
200100
200101
200102
200103
200104
20010X
20011
20012
20013
20014
2001X
20020
20021
20022
20023
20024
2002X
2003
2004
200X
201000
201001
201002
201003
201004
20100X
20101
20102
20103
20104
2010X
2011
2012
2013
2014
201X

Output
Codeword
1'h0
2'h1
5'h0B
9'h01F
10'h1DF
10'h3DF
13'h05FF
13'h15FF
14'h1FFF
9'h04F
9'h14F
12'hD7F
12'h37F
14'h07FF
8'h57
9'h0CF
9'h1CF
12'hB7F
12'h77F
14'h27FF
9'h177
10'h2DF
11'h4BF
9'h11F
10'h03F
10'h23F
13'h0DFF
13'h1DFF
15'h3FFF
9'h02F
9'h12F
12'hF7F
12'h0FF
14'h17FF
8'hFB
8'h07
11'h2BF
11'h6BF
13'h01FF

CCSDS 123.0-B-2

Input
Codeword
20200
20201
20202
20203
20204
2020X
2021
2022
2023
2024
202X
203
204
20X
210000
210001
210002
210003
210004
21000X
21001
21002
21003
21004
2100X
2101
2102
2103
2104
210X
2110
2111
2112
2113
2114
211X
2120
2121
2122

Output
Codeword
8'hD7
9'h0AF
9'h1AF
12'h8FF
12'h4FF
14'h37FF
8'h87
8'h47
11'h1BF
11'h5BF
13'h11FF
8'h7B
9'h1B7
10'h19F
9'h09F
10'h13F
10'h33F
13'h03FF
13'h13FF
15'h7FFF
9'h06F
9'h16F
12'hCFF
12'h2FF
14'h0FFF
8'hC7
8'h27
11'h3BF
11'h7BF
13'h09FF
8'hA7
9'h0F7
9'h1F7
12'hA7F
12'h67F
14'h2BFF
8'h67
9'h00F
9'h10F

Page B-7

Input
Codeword
2123
2124
212X
213
214
21X
22000
22001
22002
22003
22004
2200X
2201
2202
2203
2204
220X
2210
2211
2212
2213
2214
221X
222
223
224
22X
23
240
241
242
243
244
24X
2X
3
4
X

Output
Codeword
12'hE7F
12'h17F
14'h1BFF
10'h39F
10'h05F
11'h0BF
8'h37
9'h0EF
9'h1EF
12'hAFF
12'h6FF
14'h2FFF
8'hE7
8'h17
11'h07F
11'h47F
13'h19FF
8'h97
9'h08F
9'h18F
12'h97F
12'h57F
14'h3BFF
7'h3B
10'h25F
10'h15F
12'h27F
7'h5B
9'h077
10'h35F
10'h0DF
13'h0EFF
13'h1EFF
14'h0BFF
9'h0B7
5'h03
5'h13
7'h1B

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-12: Flush Table for Low-Entropy Code 5
Active Prefix
(null)
2
20
200
2001
20010
2002
201

Flush Word
1'h0
3'h1
3'h5
5'h0B
7'h4F
8'hBF
7'h2F
6'h1B

Active Prefix
2010
20100
202
2020
21
210
2100
21000

Flush Word
7'h6F
8'h7F
6'h3B
7'h1F
5'h03
6'h07
6'h17
8'hFF

Active Prefix
211
212
22
220
2200
221
24

Flush Word
7'h37
7'h77
5'h13
6'h27
7'h5F
7'h0F
8'h3F

Table B-13: Code Table for Low-Entropy Code 6
Input
Codeword
0000
000100
000101
000102
000103
000104
00010X
00011
00012
00013
00014
0001X
000200
000201
000202
000203
000204
00020X
00021
00022
00023
00024
0002X
0003
0004
000X
00100
00101
00102
00103
00104
0010X
0011
0012

Output
Codeword
3'h2
6'h13
8'h4F
8'hCF
12'h6FF
12'hEFF
14'h2FFF
7'h3B
7'h7B
11'h47F
11'h27F
13'h03FF
6'h33
8'h2F
8'hAF
12'h1FF
12'h9FF
14'h1FFF
7'h07
7'h47
11'h67F
12'hAFF
13'h13FF
9'h05F
9'h15F
11'h7BF
5'h15
7'h27
7'h67
11'h17F
11'h57F
13'h0BFF
6'h1D
6'h3D

CCSDS 123.0-B-2

Input
Codeword
0013
0014
001X
002
003
004
00X
01
020
0210
0211
0212
0213
0214
021X
022
023
024
02X
03
04
0X
10
1100
1101
1102
1103
1104
110X
111
112
113
114
11X

Output
Codeword
10'h2BF
11'h07F
13'h1DFF
4'h6
8'h57
8'hD7
10'h03F
3'h0
4'hE
6'h03
8'h37
8'hB7
12'hF7F
12'h0FF
14'h17FF
6'h0D
10'h23F
10'h13F
12'h37F
7'h4B
7'h2B
9'h16F
3'h4
6'h23
8'h77
8'hF7
12'h8FF
12'h4FF
14'h37FF
7'h1B
7'h5B
11'h3BF
12'hB7F
13'h0DFF

Page B-8

Input
Codeword
12
13
14
1X
200
20100
20101
20102
20103
20104
2010X
2011
2012
2013
2014
201X
202
203
204
20X
21
22
23
24
2X
30
31
32
33
34
3X
4
X

Output
Codeword
5'h09
9'h0EF
9'h1EF
11'h1BF
4'h1
7'h17
9'h0DF
9'h1DF
13'h1BFF
13'h07FF
15'h7FFF
8'h0F
8'h8F
12'hCFF
12'h2FF
14'h0FFF
6'h2D
10'h33F
10'h0BF
12'h77F
5'h19
5'h05
9'h01F
9'h11F
11'h5BF
7'h6B
9'h09F
9'h19F
13'h05FF
13'h15FF
15'h3FFF
7'h0B
9'h06F

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-14: Flush Table for Low-Entropy Code 6
Active Prefix
(null)
0
00
000
0001
00010
0002

Flush Word
2'h0
2'h2
3'h1
4'h3
6'h17
7'h5F
6'h37

Active Prefix
00020
001
0010
02
021
1
11

Flush Word
7'h3F
6'h27
6'h0F
5'h0B
7'h2F
4'h5
6'h07

Active Prefix
110
2
20
201
2010
3

Flush Word
7'h6F
4'hD
5'h1B
7'h1F
8'hFF
8'h7F

Table B-15: Code Table for Low-Entropy Code 7
Input
Codeword
00
0100
01010
01011
01012
01013
01014
0101X
01020
01021
01022
01023
01024
0102X
0103
0104
010X
011
012
013
014
01X
020
021
0220
0221
0222

Output
Codeword
1'h0
4'hD
7'h77
9'h15F
9'h0DF
15'h17FF
15'h57FF
17'h07FFF
7'h0F
9'h1DF
10'h3BF
15'h37FF
15'h77FF
17'h17FFF
12'h1FF
12'h9FF
14'h3BFF
6'h2B
6'h1B
12'h4FF
12'hCFF
14'h13FF
4'h5
6'h3B
7'h37
9'h09F
9'h19F

CCSDS 123.0-B-2

Input
Codeword
0223
0224
022X
023
024
02X
03
04
0X
1000
10010
10011
10012
10013
10014
1001X
10020
10021
10022
10023
10024
1002X
1003
1004
100X
101
102

Output
Codeword
15'h27FF
15'h67FF
16'h5FFF
12'h2FF
12'hAFF
14'h33FF
9'h1EF
9'h01F
11'h27F
4'h3
7'h4F
9'h03F
9'h13F
15'h0FFF
15'h4FFF
16'h3FFF
7'h2F
9'h0BF
10'h07F
15'h2FFF
15'h6FFF
17'h0FFFF
12'h5FF
12'hDFF
14'h07FF
6'h07
6'h27

Page B-9

Input
Codeword
103
104
10X
110
111
1120
1121
1122
1123
1124
112X
113
114
11X
12
13
14
1X
2
30
31
32
33
34
3X
4
X

Output
Codeword
12'h6FF
12'hEFF
14'h0BFF
6'h17
8'h6F
9'h05F
11'h77F
11'h0FF
16'hDFFF
17'h1BFFF
18'h3FFFF
14'h2BFF
14'h1BFF
16'h9FFF
6'h0B
11'h67F
11'h17F
13'h03FF
3'h1
9'h11F
11'h57F
11'h37F
16'h1FFF
17'h0BFFF
18'h1FFFF
9'h0EF
10'h1BF

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-16: Flush Table for Low-Entropy Code 7
Active Prefix
(null)
0
01
010
0101
0102

Flush Word
1'h0
2'h1
5'h0B
5'h17
8'hDF
8'h3F

Active Prefix
02
022
1
10
100
1001

Flush Word
5'h1B
8'h5F
4'h3
5'h07
5'h0F
8'hBF

Active Prefix
1002
11
112
3

Flush Word
8'h7F
7'h1F
9'h1FF
9'h0FF

Table B-17: Code Table for Low-Entropy Code 8
Input
Codeword
0^{10}
0^{9}1
0^{9}200
0^{9}201
0^{9}202
0^{9}20X
0^{9}21
0^{9}22
0^{9}2X
0^{9}X
0^{8}1
0^{8}2
0^{8}X
0^{7}100
0^{7}101
0^{7}102
0^{7}10X
0^{7}11
0^{7}12
0^{7}1X
0^{7}20
0^{7}21
0^{7}22
0^{7}2X
0^{7}X
0^{6}1
0^{6}200
0^{6}201
0^{6}202
0^{6}20X

Output
Codeword
3'h0
6'h0B
7'h37
10'h27F
10'h17F
15'h3FFF
10'h3BF
10'h07F
15'h5FFF
12'hDFF
6'h03
6'h23
11'h6FF
6'h2B
9'h0DF
9'h1DF
15'h1FFF
9'h01F
9'h11F
14'h37FF
6'h13
9'h09F
9'h19F
15'h6FFF
11'h2FF
5'h1D
6'h33
9'h05F
9'h15F
14'h0FFF

CCSDS 123.0-B-2

Input
Codeword
0^{6}21
0^{6}22
0^{6}2X
0^{6}X
000001
000002
00000X
000010
000011
000012
00001X
000020
000021
000022
00002X
0000X
0001
000200
000201
000202
00020X
000210
000211
000212
00021X
00022
0002X
000X
001
002

Output
Codeword
9'h0EF
9'h1EF
14'h17FF
11'h4FF
5'h09
5'h19
11'h37F
5'h05
8'hF7
8'h0F
13'h1BFF
5'h15
8'h8F
8'h4F
14'h07FF
10'h1BF
4'h1
5'h0D
8'hCF
8'h2F
14'h27FF
8'hAF
11'h77F
11'h0FF
16'hFFFF
8'h77
13'h0BFF
10'h2BF
4'hC
4'h2

Page B-10

Input
Codeword
00X
010
011
012
01X
02
0X
100
101
102
10X
110
111
112
11X
12
1X
200
201
202
20X
210
211
212
21X
22
2X
X

Output
Codeword
10'h03F
4'hA
7'h3B
7'h7B
13'h03FF
4'h4
9'h16F
4'h6
7'h07
7'h47
12'h5FF
7'h27
10'h23F
10'h13F
15'h2FFF
7'h1B
12'h1FF
4'hE
7'h67
7'h17
13'h13FF
7'h57
10'h33F
10'h0BF
16'h7FFF
7'h5B
12'h9FF
9'h06F

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-18: Flush Table for Low-Entropy Code 8
Active Prefix
(null)
0
00
000
0000
00000
0^{6}
0^{7}
0^{8}
0^{9}

Flush Word
2'h0
3'h2
3'h6
3'h1
4'h5
4'hD
5'h03
5'h13
5'h0B
5'h1B

CCSDS 123.0-B-2

Active Prefix
0^{9}2
0^{9}20
0^{7}1
0^{7}10
0^{7}2
0^{6}2
0^{6}20
00001
00002
0002

Flush Word
9'h17F
9'h0FF
8'h5F
8'hBF
8'hDF
8'h9F
8'h3F
7'h2F
8'h1F
7'h4F

Page B-11

Active Prefix
00020
00021
01
1
10
11
2
20
21

Flush Word
7'h6F
10'h3FF
6'h17
6'h07
6'h37
9'h07F
6'h27
7'h0F
10'h1FF

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-19: Code Table for Low-Entropy Code 9
Input
Codeword
0^{11}
0^{10}10
0^{10}11
0^{10}12
0^{10}1X
0^{10}2
0^{10}X
0^{9}100
0^{9}101
0^{9}102
0^{9}10X
0^{9}11
0^{9}12
0^{9}1X
0^{9}2
0^{9}X
0^{8}1000
0^{8}1001
0^{8}1002
0^{8}100X
0^{8}101
0^{8}102
0^{8}10X
0^{8}11
0^{8}12
0^{8}1X
0^{8}20
0^{8}21
0^{8}22
0^{8}2X
0^{8}X
0^{7}1
0^{7}200
0^{7}201
0^{7}202
0^{7}20X

Output
Codeword
2'h0
6'h3B
10'h1BF
10'h3BF
17'h17FFF
6'h1B
12'hBFF
6'h07
10'h07F
10'h27F
17'h0FFFF
10'h33F
10'h0BF
16'h3FFF
6'h13
12'h3FF
6'h27
10'h17F
10'h37F
17'h1FFFF
9'h19F
10'h2BF
16'hBFFF
9'h09F
10'h0DF
16'h9FFF
6'h33
10'h2DF
10'h1DF
17'h07FFF
12'hDFF
5'h03
6'h0B
10'h3DF
10'h03F
16'h5FFF

CCSDS 123.0-B-2

Input
Codeword
0^{7}21
0^{7}22
0^{7}2X
0^{7}X
0^{6}1
0^{6}2000
0^{6}2001
0^{6}2002
0^{6}200X
0^{6}201
0^{6}202
0^{6}20X
0^{6}21
0^{6}22
0^{6}2X
0^{6}X
000001
000002
00000X
000010
000011
000012
00001X
00002
0000X
000100
000101
000102
00010X
00011
00012
0001X
00020
00021
00022
0002X

Output
Codeword
9'h01F
10'h15F
16'hEFFF
12'h5FF
5'h1D
6'h2B
10'h23F
10'h13F
16'hDFFF
9'h11F
10'h35F
16'h1FFF
9'h1EF
10'h25F
16'h6FFF
12'h9FF
5'h09
5'h19
12'h1FF
5'h05
9'h12F
9'h0AF
15'h77FF
5'h0E
11'h6FF
5'h15
9'h1AF
9'h06F
15'h0FFF
8'hB7
9'h10F
15'h17FF
5'h1E
9'h08F
9'h18F
16'h2FFF

Page B-12

Input
Codeword
000X
001000
001001
001002
00100X
00101
00102
0010X
0011
0012
001X
00200
00201
00202
0020X
0021
0022
002X
00X
01
02000
02001
02002
0200X
0201
0202
020X
021
022
02X
0X
1
2
X

Output
Codeword
11'h2FF
5'h0D
9'h16F
9'h0EF
15'h4FFF
8'h77
9'h04F
15'h57FF
8'h97
8'h57
15'h47FF
5'h01
9'h14F
9'h0CF
16'hAFFF
8'hD7
9'h1F7
15'h27FF
11'h4FF
4'h6
5'h11
9'h1CF
9'h02F
15'h37FF
8'h37
9'h00F
15'h67FF
8'h17
9'h0F7
15'h07FF
11'h0FF
4'h2
4'hA
10'h05F

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Cor. 3

Table B-20: Flush Table for Low-Entropy Code 9
Active Prefix
0^{r}, 0≤r≤3
0^{r}, 4≤r≤8
0^{r}, 9≤r≤10
001
0^{r}1, 3≤r≤4
0^{8}1
0^{9}1
0^{10}1
0^{r}2, 1≤r≤2
0^{r}2, 6≤r≤7
0^{8}2

CCSDS 123.0-B-2 Cor. 3

Flush Word
<3'h(0+r)>
<4'h(4+r)>
<5'h(11+r)>
7'h47
<7'h(6E+2r)>
8'h1F
8'h3F
9'h0FF
<7'h(6E+2r)>
<8'h(EF+r)>
8'h9F

Active Prefix
0^{r}10, 2≤r≤3
0^{8}10
0^{9}10
020
0020
0^{6}20
0^{7}20
00100
0^{8}100
0200
0^{6}200
0002

Page B-13

Flush Word
<7'h(71+2r)>
8'hBF
9'h1FF
7'h67
8'hCF
8'hEF
8'h5F
7'h0F
8'h7F
8'h2F
8'hDF
8'h4F

February
February2019
2021

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-21: Code Table for Low-Entropy Code 10
Input Codeword
0^{9}
0001
0^{r}1, 4≤r≤6
0^{r}2, 0≤r≤2
0002
0^{r}X, 0≤r≤1
0^{r}X, 2≤r≤8
0010
0^{r}11, 0≤r≤1
0011
0^{7}11
0^{8}11
0^{r}12, 0≤r≤1
0012
0^{7}12
0^{8}12
1X
0^{r}1X, 1≤r≤2
0^{7}1X
0^{8}1X
0^{8}20
0^{r}21, 4≤r≤5
0^{6}21
0^{7}21
0^{8}21
0^{r}22, 4≤r≤5
0^{6}22
0^{7}22
0^{8}22
00002X
0^{r}2X, 5≤r≤6
0^{7}2X
0^{8}2X
0100
101
0101
0^{7}101
0^{8}101
102
0102

CCSDS 123.0-B-2

Output Codeword
1'h0
5'h19
<5'h(14+r)>
<5'h(10+r)>
5'h05
<12'h(FFA+r)>
<13'h(1FF6+r)>
5'h15
<9'h(1E8+r)>
10'h26F
10'h05F
10'h1DF
<10'h(3D6+r)>
10'h16F
10'h25F
10'h3DF
17'h01FFF
<17'h(1FFEF+2r)>
18'h33FFF
18'h07FFF
6'h27
<10'h(3D7+2r)>
10'h29F
10'h15F
10'h03F
<10'h(3D8+2r)>
11'h07F
11'h67F
11'h77F
17'h0DFFF
<18'h(3FFE4+2r)>
18'h0BFFF
18'h27FFF
5'h0D
9'h0AF
10'h36F
10'h23F
10'h0BF
10'h06F
10'h0EF

Input Codeword
0^{7}102
0^{8}102
0^{r}10X, 0≤r≤1
0^{r}10X, 7≤r≤8
0^{6}200
0^{7}200
0000201
00000201
0^{6}201
0^{7}201
0000202
00000202
0^{6}202
0^{7}202
0^{r}20X, 4≤r≤5
0^{6}20X
0^{7}20X
1000
0^{8}1000
1001
0^{r}1001, 7≤r≤8
1002
0^{r}1002, 7≤r≤8
100X
0^{r}100X, 7≤r≤8
000002000
00002001
000002001
00002002
000002002
0000200X
00000200X
0^{7}10000
0^{7}10001
0^{7}10002
0^{7}1000X
000020000
000020001
000020002
00002000X

Page B-14

Output Codeword
10'h13F
11'h4FF
<17'h(1FFF2+2r)>
<18'h(3FFEC+2r)>
6'h1B
6'h17
10'h31F
10'h19F
10'h35F
10'h33F
10'h09F
11'h47F
11'h17F
11'h0FF
<18'h(3FFE7+2r)>
18'h2BFFF
18'h37FFF
5'h1D
6'h37
10'h2EF
<10'h(3EE+r)>
10'h1EF
<11'h(7F3+r)>
17'h15FFF
<18'h(3FFF6+r)>
6'h3B
10'h39F
10'h0DF
11'h27F
11'h57F
18'h13FFF
18'h1BFFF
6'h0F
10'h3BF
11'h1FF
18'h3FFFF
6'h07
10'h2DF
11'h37F
18'h3BFFF

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-22: Flush Table for Low-Entropy Code 10
Active Prefix
0^{r}, 0≤r≤5
0^{r}, 6≤r≤8
1
0^{r}1, 1≤r≤2
0^{7}1
0^{8}1
00002
0^{r}2, 5≤r≤6
0^{7}2
0^{8}2
0^{r}10, 0≤r≤1

CCSDS 123.0-B-2

Flush Word
<3'h(0+r)>
<4'h(6+r)>
8'h0F
<8'h(EF+2r)>
9'h19F
9'h03F
8'h6F
<9'h(1E4+2r)>
9'h05F
9'h13F
<8'h(F2+2r)>

Active Prefix
0^{r}10, 7≤r≤8
0^{r}20, 4≤r≤5
0^{6}20
0^{7}20
100
0^{r}100, 7≤r≤8
0000200
00000200
0^{7}1000
00002000

Page B-15

Flush Word
<9'h(1EC+2r)>
<9'h(1E7+2r)>
9'h15F
9'h1BF
8'hAF
<9'h(1F6+r)>
9'h09F
9'h0DF
9'h1FF
9'h1DF

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-23: Code Table for Low-Entropy Code 11
Input Codeword
0^{16}
1
0^{7}1
0^{r}1, 8≤r≤10
0^{r}1, 11≤r≤15
002
0^{r}2, 3≤r≤6
0^{7}2
0^{r}2, 8≤r≤10
0^{14}2
0^{15}2
0^{r}X, 0≤r≤6
0^{r}X, 7≤r≤15
0^{6}10
011
0011
00011
000011
0000011
0^{6}11
012
0012
00012
000012
0000012
0^{6}12
01X
0^{r}1X, 2≤r≤3
00001X
000001X
0^{6}1X
020
0^{r}20, 12≤r≤13
21
021
0^{r}21, 11≤r≤12
0^{13}21
22
022
0^{r}22, 11≤r≤12
0^{13}22
0^{r}2X, 0≤r≤1
0^{11}2X
0^{r}2X, 12≤r≤13
0000100
00000100
0101
00101

CCSDS 123.0-B-2

Output Codeword
1'h0
5'h01
6'h0D
<6'h(21+2r)>
<6'h(2C+r)>
6'h11
<6'h(22+r)>
6'h2D
<6'h(22+2r)>
7'h4F
7'h1F
<14'h(3FF4+r)>
<15'h(7FEF+r)>
6'h1D
11'h25F
11'h0DF
11'h1DF
11'h23F
11'h2BF
11'h17F
11'h65F
11'h4DF
11'h5DF
11'h63F
11'h6BF
11'h57F
19'h07FFF
<19'h(7FFED+2r)>
20'hF7FFF
20'hCFFFF
20'h1FFFF
6'h31
<7'h(60+2r)>
11'h05F
11'h15F
<12'h(FDD+2r)>
12'h9FF
11'h45F
11'h55F
<12'h(FDE+2r)>
12'h5FF
<20'h(FFFEC+r)>
20'hDFFFF
<20'h(FFFE4+2r)>
6'h25
6'h3D
11'h2DF
11'h3DF

Input Codeword
000101
0000101
00000101
0102
00102
000102
0000102
00000102
0^{r}10X, 1≤r≤2
00010X
000010X
0000010X
200
201
0^{11}201
202
0^{11}202
20X
0^{11}20X
0001000
01001
001001
0001001
01002
001002
0001002
0100X
00100X
000100X
0^{11}2000
0^{11}2001
0^{11}2002
0^{11}200X
0010000
010001
0010001
010002
0010002
01000X
001000X
0100001
0100002
010000X
01000000
01000001
01000002
0100000X

Page B-16

Output Codeword
11'h13F
11'h1BF
11'h37F
11'h6DF
11'h7DF
11'h53F
11'h5BF
11'h77F
<19'h(7FFF0+2r)>
20'h0FFFF
20'h2FFFF
20'h9FFFF
6'h09
11'h35F
12'hEFF
11'h75F
12'h1FF
20'h77FFF
20'hBFFFF
6'h15
11'h03F
11'h33F
11'h3BF
11'h43F
11'h73F
11'h7BF
19'h57FFF
20'h8FFFF
20'hAFFFF
7'h6F
12'hDFF
12'h3FF
20'hFFFFF
6'h35
11'h0BF
11'h07F
11'h4BF
11'h47F
20'h4FFFF
20'h6FFFF
11'h27F
11'h67F
20'hEFFFF
6'h03
11'h0FF
12'h4FF
20'h5FFFF

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-24: Flush Table for Low-Entropy Code 11
Active Prefix
0^{r}, 0≤r≤14
0^{15}
01
0^{r}1, 2≤r≤3
00001
000001
0^{6}1
0^{r}2, 0≤r≤1
0^{11}2
0^{r}2, 12≤r≤13
0^{r}10, 1≤r≤2
00010

Flush Word
<4'h(0+r)>
5'h0F
9'h01F
<9'h(1ED+2r)>
10'h3DF
10'h33F
10'h07F
<10'h(3EC+r)>
10'h37F
<10'h(3E4+2r)>
<9'h(1F0+2r)>
10'h03F

Active Prefix
000010
0000010
20
0^{11}20
0100
00100
000100
0^{11}200
01000
001000
010000
0100000

Flush Word
10'h0BF
10'h27F
10'h1DF
10'h2FF
9'h15F
10'h23F
10'h2BF
10'h3FF
10'h13F
10'h1BF
10'h3BF
10'h17F

Cor. 3

Table B-25: Code Table for Low-Entropy Code 12
Input Codeword
0^{27}
1
0^{r}1, 1≤r≤8
0^{11}1
0^{r}1, 12≤r≤26
2
00002
0^{r}2, 5≤r≤10
0^{11}2
0^{r}2, 12≤r≤25
0^{26}2
0^{r}X, 0≤r≤12
0^{r}X, 13≤r≤25
0^{26}X
0^{10}10
0^{r}11, 9≤r≤10
0^{r}12, 9≤r≤10
0^{r}1X, 9≤r≤10
00020

Output Codeword
1'h0
6'h01
<6'h(21+r)>
7'h3D
<7'h(4A+2r)>
6'h21
7'h15
<7'h(53+r)>
7'h7D
<7'h(4B+2r)>
8'h7F
<15'h(7FEC+r)>
<16'h(FFE5+r)>
17'h0FFFF
7'h03
<12'h(FED+r)>
<13'h(1FEF+r)>
<20'h(FFFF3+r)>
7'h55

Input Codeword
021
0^{r}21, 2≤r≤3
022
0^{r}22, 2≤r≤3
02X
0^{r}2X, 2≤r≤3
0^{9}100
0^{9}101
0^{9}102
0^{9}10X
00200
0^{r}201, 1≤r≤2
0^{r}202, 1≤r≤2
020X
0020X
02000
02001
02002
0200X

Output Codeword
12'h0FF
<12'h(FED+2r)>
13'h09FF
<13'h(1FEF+2r)>
20'h1FFFF
<20'h(FFFF5+2r)>
7'h43
12'h1FF
13'h0BFF
20'h7FFFF
7'h35
<12'h(FF0+2r)>
<13'h(1FF2+2r)>
20'h5FFFF
21'h0FFFFF
7'h75
12'hAFF
13'h1DFF
21'h1FFFFF

Table B-26: Flush Table for Low-Entropy Code 12
Active Prefix
0^{r}, 0≤r≤4
0^{r}, 5≤r≤25
0^{26}
0^{r}1, 9≤r≤10
0^{r}2, 1≤r≤2

CCSDS 123.0-B-2 Cor. 3

Flush Word
<4'h(0+r)>
<5'h(5+r)>
6'h1F
<9'h(1F3+r)>
<9'h(1F7+r)>

Active Prefix
0002
0^{9}10
020
0020
0200

Page B-17

Flush Word
10'h1FF
9'h0FF
9'h0BF
10'h3FF
9'h1BF

February
February2019
2021

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

Table B-27: Code Table for Low-Entropy Code 13
Input Codeword
0^{46}
0^{r}1, 1≤r≤2
0^{r}1, 3≤r≤8
0^{r}1, 9≤r≤26
0^{r}1, 27≤r≤45
0^{r}2, 0≤r≤2
0^{r}2, 3≤r≤8
0^{r}2, 9≤r≤25
0^{r}2, 26≤r≤44
0^{45}2

Output Codeword
1'h0
<7'h(3F+2r)>
<7'h(40+2r)>
<7'h(49+r)>
<8'h(A4+2r)>
<7'h(40+2r)>
<7'h(41+2r)>
<8'h(BF+r)>
<8'h(A5+2r)>
9'h0FF

Input Codeword
0^{r}X, 0≤r≤17
0^{r}X, 18≤r≤44
0^{45}X
11
12
1X
100
101
102
10X

Output Codeword
<15'h(7FE0+r)>
<16'h(FFD2+r)>
17'h0FFFF
12'h1FF
12'h9FF
18'h1FFFF
7'h51
12'h5FF
12'hDFF
18'h3FFFF

Table B-28: Flush Table for Low-Entropy Code 13
Active Prefix
0^{r}, 0≤r≤17
0^{r}, 18≤r≤44
0^{45}

Flush Word
<5'h(0+r)>
<6'h(12+r)>
7'h3F

Active Prefix
1
10

Flush Word
8'h7F
8'hFF

Table B-29: Code Table for Low-Entropy Code 14
Input Codeword
0^{85}
0^{r}1, 0≤r≤20
0^{r}1, 21≤r≤64
0^{r}1, 65≤r≤84
0^{r}2, 0≤r≤20

Output Codeword
1'h0
<8'h(80+2r)>
<8'h(95+r)>
<9'h(156+2r)>
<8'h(81+2r)>

Input Codeword
0^{r}2, 21≤r≤64
0^{r}2, 65≤r≤83
0^{84}2
0^{r}X, 0≤r≤42
0^{r}X, 43≤r≤84

Output Codeword
<9'h(197+r)>
<9'h(157+2r)>
10'h1FF
<16'h(FFC0+r)>
<17'h(1FFAB+r)>

Table B-30: Flush Table for Low-Entropy Code 14
Active Prefix
0^{r}, 0≤r≤42
0^{r}, 43≤r≤84

Flush Word
<6'h(0+r)>
<7'h(2B+r)>

Table B-31: Code Table for Low-Entropy Code 15
Input Codeword
0^{256}
0^{r}X, 0≤r≤255

Output Codeword
1'h0
<9'h(100+r)>

Table B-32: Flush Table for Low-Entropy Code 15
Active Prefix
0^{r}, 0≤r≤255

CCSDS 123.0-B-2

Flush Word
<8'h(0+r)>

Page B-18

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

ANNEX C
SECURITY, SANA, AND PATENT CONSIDERATIONS
(INFORMATIVE)
C1

SECURITY CONSIDERATIONS

C1.1

SECURITY BACKGROUND

It is assumed that security is provided by encryption, authentication methods, and access
control to be performed at the application and/or transport layers. Mission and service
providers are expected to select from recommended security methods suitable to the specific
application profile. Specification of these security methods and other security provisions is
outside the scope of this Recommended Standard.
C1.2

SECURITY CONCERNS

Security concerns in the areas of data privacy, integrity, authentication, access control,
availability of resources, and auditing are to be addressed in the appropriate layers and are
not related to this Recommended Standard. The use of lossless data compression does not
affect the proper functioning of methods used to achieve such protection.
The use of lossless data compression slightly improves data integrity because the alteration
of even a single bit of compressed data is likely to cause conspicuous and easily detectible
corruption of the reconstructed data, thus making it more likely that malicious data alteration
will be detected.
C1.3

POTENTIAL THREATS AND ATTACK SCENARIOS

An eavesdropper will not be able to decompress compressed data if proper encryption is
performed at a lower layer.
C1.4

CONSEQUENCES OF NOT APPLYING SECURITY

There are no specific security measures prescribed for compressed data. Therefore,
consequences of not applying security are only imputable to the lack of proper security
measures in other layers.
C2

SANA CONSIDERATIONS

The recommendations of this document do not require any action from SANA.

CCSDS 123.0-B-2

Page C-1

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

C3

PATENT CONSIDERATIONS

At time of publication, the specifications of this Recommended Standard are not known to be
the subject of patent rights.

CCSDS 123.0-B-2

Page C-2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

ANNEX D
REFERENCES
(INFORMATIVE)
[D1] Lossless Multispectral and Hyperspectral Image Compression. Issue 2. Report
Concerning Space Data System Standards (Green Book), CCSDS 120.2-G-2.
Forthcoming.
[D2] Lossless Multispectral & Hyperspectral Image Compression. Issue 1. Recommendation
for Space Data System Standards (Blue Book), CCSDS 123.0-B-1. Washington, D.C.:
CCSDS, May 2012.
[D3] Space Packet Protocol. Issue 1. Recommendation for Space Data System Standards
(Blue Book), CCSDS 133.0-B-1. Washington, D.C.: CCSDS, September 2003.
[D4] CCSDS File Delivery Protocol (CFDP). Issue 4. Recommendation for Space Data
System Standards (Blue Book), CCSDS 727.0-B-4. Washington, D.C.: CCSDS,
January 2007.
[D5] AOS Space Data Link Protocol. Issue 3. Recommendation for Space Data System
Standards (Blue Book), CCSDS 732.0-B-3. Washington, D.C.: CCSDS, September 2015.
[D6] TM Space Data Link Protocol. Issue 2. Recommendation for Space Data System
Standards (Blue Book), CCSDS 132.0-B-2. Washington, D.C.: CCSDS, September
2015.
[D7] Unified Space Data Link Protocol. Issue 1. Recommendation for Space Data System
Standards (Blue Book), CCSDS 732.1-B-1. Washington, D.C.: CCSDS, October 2018.

CCSDS 123.0-B-2

Page D-1

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

ANNEX E
TABLES OF SYMBOLS USED
(INFORMATIVE)
This annex tabulates symbols used in this Recommended Standard.
Table E-1: Coordinate Indices and Image Quantities
Symbol
x, y, z
t

sz,y,x , sz(t)
NX , NY , NZ
Fy
D

smin , smax
smid
τ
iz , iz,x
DI
bz , bz,x
jz , jz,x
αz , αz,x
β
DF
DE

Meaning
image coordinate indices
alternate image coordinate index
image data sample

Reference
3.2.1
3.4
3.2.1

image dimensions (user-specified)

3.2.2

frame
image dynamic range in bits (user-specified)
lower and upper sample value limits

3.2.3
3.3.1
3.3.2

mid-range sample value

3.3.2

number of supplementary information tables (user-specified)
integer supplementary information table data value (optional, userspecified)
integer supplementary information table bit depth (optional, userspecified)
float supplementary information table sign bit (optional, userspecified)
float supplementary information table significand (optional, userspecified)
float supplementary information table exponent (optional, userspecified)
float supplementary information table exponent bias (optional, userspecified)
float supplementary information table significand bit depth (optional,
user-specified)
float supplementary information table exponent bit depth (optional,
user-specified)

3.5.2.1
3.5.2.3
3.5.2.3
3.5.2.3
3.5.2.3
3.5.2.3
3.5.2.3.3
3.5.2.3.3
3.5.2.3.3

Table E-2: Predictor Quantities
Symbol

Meaning

Reference

P

number of spectral bands used for prediction (user-specified)

4.2

*
z

P

number of previous spectral bands used for prediction in band z

4.2

Cz

number of local difference values used for prediction in band z

4.3.2

σz,y,x

local sum

4.4

CCSDS 123.0-B-2

Page E-1

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION
Symbol

dz,y,x , dz(t)

Meaning

Reference

central local difference

4.5.1

directional local differences

4.5.2

local difference vector

4.5.3

weight resolution (user-specified)

4.6.1

minimum and maximum weight values

4.6.1.3

weight vector

4.6.2

weight values

4.6.2

Λz

weight initialization vector (optional, user-specified)

4.6.3.3

Q

weight initialization resolution (optional, user-specified)

4.6.3.3

predicted central local difference

4.7.1

high-resolution predicted sample value

4.7.2

R

register size, in bits, used in prediction calculation (userspecified)

4.7.2

sz (t )

double-resolution predicted sample value

4.7.3

predicted sample value

4.7.4

Δz(t)

prediction residual

4.8.1

mz(t)

maximum error

4.8.2.1

qz(t)

quantizer index

4.8.1

az

absolute error limit (optional, user-specified)

4.8.2

rz

relative error limit (optional, user-specified)

4.8.2

DA

absolute error limit bit depth (optional, user-specified)

4.8.2.2.1

DR

relative error limit bit depth (optional, user-specified)

4.8.2.2.2

*

A

absolute error limit constant (optional, user-specified)

4.8.2.3.1

*

R
u
Θ
ϕz

relative error limit constant (optional, user-specified)

4.8.2.3.1

error limit update period exponent (optional, user-specified)

4.8.2.4

sample representative resolution (user-specified)

4.9.1

sample representative damping (user-specified)

4.9.1

ѱz

sample representative offset (user-specified)

4.9.1

s′′z (t )

sample representative

4.9.2

d zN,y , x , d zW,y , x , d zNW
, y,x ,

d zN (t ) , d zW (t ) ,
d

NW
z

(t )

U z (t )
Ω
ωmin , ωmax
Wz (t )

ω zN (t ) , ω zW (t ) ,

ω zNW (t ) , ω z(i ) (t )

dˆz (t )

sz (t )

sˆz (t ) , sˆz , y , x

CCSDS 123.0-B-2

Page E-2

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION
Symbol

Meaning

Reference

s′′z (t )

double-resolution sample representative

4.9.2

s′z (t )

clipped quantizer bin center

4.9.2

ez(t)

double-resolution prediction error

4.10.1

ρ(t)

weight update scaling exponent

4.10.2

initial and final weight update scaling exponent parameters
(user-specified)

4.10.2

weight update scaling exponent change interval (user-specified)

4.10.2

ς z(i ) , ς z*

weight update scaling exponent offsets (user-specified)

4.10.3

δz(t), δz,y,x

mapped quantizer index

4.11

scaled difference between sˆz (t ) and nearest endpoint smin, smax

4.11

vmin , vmax
tinc

θz(t)

Table E-3: Encoder Quantities
Symbol
B

Meaning
output word size in bytes (user-specified)

Reference
5.2.2

M

sub-frame interleaving depth (optional, user-specified)

5.4.2.2

ℜk ( j )

Sample-Adaptive Entropy Coder
length-limited GPO2 codeword

5.4.3.2.2.1

Umax

unary length limit (user-specified)

5.4.3.2.2.2

Σz(t)

accumulator

5.4.3.2.3

Γ(t)
γ0

counter

5.4.3.2.3

initial count exponent (user-specified)

5.4.3.2.3.2

accumulator initialization parameters (user-specified)

5.4.3.2.3.3

accumulator initialization constant (optional, user-specified)

5.4.3.2.3.3

rescaling counter size (user-specified)

5.4.3.2.3.4

variable length code parameter

5.4.3.2.4.3

ℜ′k ( j )

Hybrid Entropy Coder
reversed length-limited GPO2 codeword

5.4.3.3.3.2.1

Umax

unary length limit (user-specified)

5.4.3.3.3.2

Ti

low-entropy code threshold value

5.4.3.3.3.3.1

Li

low-entropy code input symbol limit

5.4.3.3.3.3.1

Σ z (t )

high-resolution accumulator

5.4.3.3.4.1

Γ(t)
γ0

counter

5.4.3.3.4.1

initial count exponent (user-specified)

5.4.3.3.4.2

k z′ , k z′′
K
*
γ
kz(t)

CCSDS 123.0-B-2

Page E-3

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION
*

γ
kz(t)

rescaling counter size (user-specified)

5.4.3.3.4.4

high-entropy variable length code parameter

5.4.3.3.5.2

ɩz(t)

low-entropy code input symbol

5.4.3.3.5.3

Block-Adaptive Entropy Coder

n

resolution

5.4.3.4.2.3

J

block size (user-specified)

5.4.3.4.2.4

r

reference sample interval (user-specified)

5.4.3.4.2.5

CCSDS 123.0-B-2

Page E-4

February 2019

CCSDS RECOMMENDED STANDARD FOR LOW-COMPLEXITY LOSSLESS & NEARLOSSLESS MULTISPECTRAL & HYPERSPECTRAL IMAGE COMPRESSION

ANNEX F
ABBREVIATIONS AND ACRONYMS
(INFORMATIVE)
AOS

Advanced Orbiting Systems

BI

band-interleavedBIL

BIP

band-interleaved-by-pixel

BSQ

band-sequentialCDS

CFDP

CCSDS File Delivery Protocol

GPO2

Golomb-power-of-2

ICS

implementation conformance statement

MSB

most significant bit

RL

requirements list

SANA

Space Assigned Numbers Authority

CCSDS 123.0-B-2

band-interleaved-by-line

coded data set

Page F-1

February 2019

